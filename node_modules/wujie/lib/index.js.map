{"version":3,"file":"index.js","mappings":"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","sources":["webpack://wujie/webpack/universalModuleDefinition","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/typeof.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/regenerator/index.js","webpack://wujie/webpack/bootstrap","webpack://wujie/webpack/runtime/compat get default export","webpack://wujie/webpack/runtime/define property getters","webpack://wujie/webpack/runtime/hasOwnProperty shorthand","webpack://wujie/webpack/runtime/make namespace object","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://wujie/./src/constant.ts","webpack://wujie/./src/utils.ts","webpack://wujie/./src/template.ts","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://wujie/./src/plugin.ts","webpack://wujie/./src/entry.ts","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/construct.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://wujie/./src/common.ts","webpack://wujie/./src/effect.ts","webpack://wujie/./src/shadow.ts","webpack://wujie/./src/sync.ts","webpack://wujie/./src/iframe.ts","webpack://wujie/./src/proxy.ts","webpack://wujie/./src/event.ts","webpack://wujie/./src/sandbox.ts","webpack://wujie/./src/index.ts","webpack://wujie/../../node_modules/.pnpm/@babel+runtime@7.18.9/node_modules/@babel/runtime/helpers/esm/inherits.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"wujie\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"wujie\"] = factory();\n\telse\n\t\troot[\"wujie\"] = factory();\n})(self, function() {\nreturn ","var _typeof = require(\"./typeof.js\")[\"default\"];\n\nfunction _regeneratorRuntime() {\n  \"use strict\";\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n      Op = Object.prototype,\n      hasOwn = Op.hasOwnProperty,\n      $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n      iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n      asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n      toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n        generator = Object.create(protoGenerator.prototype),\n        context = new Context(tryLocsList || []);\n    return generator._invoke = function (innerFn, self, context) {\n      var state = \"suspendedStart\";\n      return function (method, arg) {\n        if (\"executing\" === state) throw new Error(\"Generator is already running\");\n\n        if (\"completed\" === state) {\n          if (\"throw\" === method) throw arg;\n          return doneResult();\n        }\n\n        for (context.method = method, context.arg = arg;;) {\n          var delegate = context.delegate;\n\n          if (delegate) {\n            var delegateResult = maybeInvokeDelegate(delegate, context);\n\n            if (delegateResult) {\n              if (delegateResult === ContinueSentinel) continue;\n              return delegateResult;\n            }\n          }\n\n          if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n            if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n            context.dispatchException(context.arg);\n          } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n          state = \"executing\";\n          var record = tryCatch(innerFn, self, context);\n\n          if (\"normal\" === record.type) {\n            if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n            return {\n              value: record.arg,\n              done: context.done\n            };\n          }\n\n          \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n        }\n      };\n    }(innerFn, self, context), generator;\n  }\n\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n\n  function Generator() {}\n\n  function GeneratorFunction() {}\n\n  function GeneratorFunctionPrototype() {}\n\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n      NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n            value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n\n      reject(record.arg);\n    }\n\n    var previousPromise;\n\n    this._invoke = function (method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function (resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n    };\n  }\n\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n            next = function next() {\n          for (; ++i < iterable.length;) {\n            if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n          }\n\n          return next.value = undefined, next.done = !0, next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    return {\n      next: doneResult\n    };\n  }\n\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, \"constructor\", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (object) {\n    var keys = [];\n\n    for (var key in object) {\n      keys.push(key);\n    }\n\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n            record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n              hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n\n          return thrown;\n        }\n      }\n\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\n\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\n\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","// \nexport const WUJIE_APP_ID = \"data-wujie-id\";\nexport const WUJIE_SCRIPT_ID = \"data-wujie-script-id\";\nexport const WUJIE_DATA_FLAG = \"data-wujie-Flag\";\nexport const CONTAINER_POSITION_DATA_FLAG = \"data-container-position-flag\";\nexport const CONTAINER_OVERFLOW_DATA_FLAG = \"data-container-overflow-flag\";\nexport const LOADING_DATA_FLAG = \"data-loading-flag\";\nexport const WUJIE_DATA_ATTACH_CSS_FLAG = \"data-wujie-attach-css-flag\";\n\n// \nexport const WUJIE_IFRAME_CLASS = \"wujie_iframe\";\nexport const WUJIE_ALL_EVENT = \"_wujie_all_event\";\nexport const WUJIE_SHADE_STYLE =\n  \"position: fixed; z-index: 2147483647; visibility: hidden; inset: 0px; backface-visibility: hidden;\";\nexport const WUJIE_LOADING_STYLE =\n  \"position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; z-index:1;\";\n\nexport const WUJIE_LOADING_SVG = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24px\" height=\"30px\" viewBox=\"0 0 24 30\">\n<rect x=\"0\" y=\"13\" width=\"4\" height=\"5\" fill=\"#909090\">\n  <animate attributeName=\"height\" attributeType=\"XML\" values=\"5;21;5\" begin=\"0s\" dur=\"0.6s\" repeatCount=\"indefinite\"></animate>\n  <animate attributeName=\"y\" attributeType=\"XML\" values=\"13; 5; 13\" begin=\"0s\" dur=\"0.6s\" repeatCount=\"indefinite\"></animate>\n</rect>\n<rect x=\"10\" y=\"13\" width=\"4\" height=\"5\" fill=\"#909090\">\n  <animate attributeName=\"height\" attributeType=\"XML\" values=\"5;21;5\" begin=\"0.15s\" dur=\"0.6s\" repeatCount=\"indefinite\"></animate>\n  <animate attributeName=\"y\" attributeType=\"XML\" values=\"13; 5; 13\" begin=\"0.15s\" dur=\"0.6s\" repeatCount=\"indefinite\"></animate>\n</rect>\n<rect x=\"20\" y=\"13\" width=\"4\" height=\"5\" fill=\"#909090\">\n  <animate attributeName=\"height\" attributeType=\"XML\" values=\"5;21;5\" begin=\"0.3s\" dur=\"0.6s\" repeatCount=\"indefinite\"></animate>\n  <animate attributeName=\"y\" attributeType=\"XML\" values=\"13; 5; 13\" begin=\"0.3s\" dur=\"0.6s\" repeatCount=\"indefinite\"></animate>\n</rect>\n</svg>`;\n\n// \nexport const WUJIE_TIPS_NO_URL = \"url\";\nexport const WUJIE_TIPS_RELOAD_DISABLED = \"reload\";\nexport const WUJIE_TIPS_STOP_APP = \"iframe\";\nexport const WUJIE_TIPS_STOP_APP_DETAIL = WUJIE_TIPS_STOP_APP + \"https://github.com/Tencent/wujie/issues/54\";\nexport const WUJIE_TIPS_NO_SUBJECT = \"\";\nexport const WUJIE_TIPS_NO_FETCH = \"windowfetchpolyfill\";\nexport const WUJIE_TIPS_NOT_SUPPORTED = \"iframe\";\nexport const WUJIE_TIPS_SCRIPT_ERROR_REQUESTED = \"\";\nexport const WUJIE_TIPS_CSS_ERROR_REQUESTED = \"\";\nexport const WUJIE_TIPS_HTML_ERROR_REQUESTED = \"html\";\nexport const WUJIE_TIPS_REPEAT_RENDER = \"\";\nexport const WUJIE_TIPS_NO_SCRIPT = \"Script\";\n","import {\n  WUJIE_SCRIPT_ID,\n  WUJIE_TIPS_NO_URL,\n  WUJIE_APP_ID,\n  WUJIE_TIPS_STOP_APP,\n  WUJIE_TIPS_STOP_APP_DETAIL,\n} from \"./constant\";\nimport { plugin, cacheOptions } from \"./index\";\n\nexport function toArray<T>(array: T | T[]): T[] {\n  return Array.isArray(array) ? array : [array];\n}\n\nexport function isFunction(value: any): boolean {\n  return typeof value === \"function\";\n}\n\nexport function isHijackingTag(tagName?: string) {\n  return (\n    tagName?.toUpperCase() === \"LINK\" ||\n    tagName?.toUpperCase() === \"STYLE\" ||\n    tagName?.toUpperCase() === \"SCRIPT\" ||\n    tagName?.toUpperCase() === \"IFRAME\"\n  );\n}\n\nexport const wujieSupport = window.Proxy && window.CustomElementRegistry;\n\n/**\n * in safari\n * typeof document.all === 'undefined' // true\n * typeof document.all === 'function' // true\n * We need to discriminate safari for better performance\n */\nconst naughtySafari = typeof document.all === \"function\" && typeof document.all === \"undefined\";\nconst callableFnCacheMap = new WeakMap<CallableFunction, boolean>();\nexport const isCallable = (fn: any) => {\n  if (callableFnCacheMap.has(fn)) {\n    return true;\n  }\n\n  const callable = naughtySafari ? typeof fn === \"function\" && typeof fn !== \"undefined\" : typeof fn === \"function\";\n  if (callable) {\n    callableFnCacheMap.set(fn, callable);\n  }\n  return callable;\n};\n\nconst boundedMap = new WeakMap<CallableFunction, boolean>();\nexport function isBoundedFunction(fn: CallableFunction) {\n  if (boundedMap.has(fn)) {\n    return boundedMap.get(fn);\n  }\n  const bounded = fn.name.indexOf(\"bound \") === 0 && !fn.hasOwnProperty(\"prototype\");\n  boundedMap.set(fn, bounded);\n  return bounded;\n}\n\nconst fnRegexCheckCacheMap = new WeakMap<any | FunctionConstructor, boolean>();\nexport function isConstructable(fn: () => any | FunctionConstructor) {\n  const hasPrototypeMethods =\n    fn.prototype && fn.prototype.constructor === fn && Object.getOwnPropertyNames(fn.prototype).length > 1;\n\n  if (hasPrototypeMethods) return true;\n\n  if (fnRegexCheckCacheMap.has(fn)) {\n    return fnRegexCheckCacheMap.get(fn);\n  }\n\n  let constructable = hasPrototypeMethods;\n  if (!constructable) {\n    const fnString = fn.toString();\n    const constructableFunctionRegex = /^function\\b\\s[A-Z].*/;\n    const classRegex = /^class\\b/;\n    constructable = constructableFunctionRegex.test(fnString) || classRegex.test(fnString);\n  }\n\n  fnRegexCheckCacheMap.set(fn, constructable);\n  return constructable;\n}\n\nconst setFnCacheMap = new WeakMap<CallableFunction, CallableFunction>();\nexport function checkProxyFunction(value: any) {\n  if (isCallable(value) && !isBoundedFunction(value) && !isConstructable(value)) {\n    if (!setFnCacheMap.has(value)) {\n      setFnCacheMap.set(value, value);\n    }\n  }\n}\n\nexport function getTargetValue(target: any, p: any): any {\n  const value = target[p];\n  if (setFnCacheMap.has(value)) {\n    return setFnCacheMap.get(value);\n  }\n  if (isCallable(value) && !isBoundedFunction(value) && !isConstructable(value)) {\n    const boundValue = Function.prototype.bind.call(value, target);\n    setFnCacheMap.set(value, boundValue);\n\n    for (const key in value) {\n      boundValue[key] = value[key];\n    }\n    if (value.hasOwnProperty(\"prototype\") && !boundValue.hasOwnProperty(\"prototype\")) {\n      // https://github.com/kuitos/kuitos.github.io/issues/47\n      Object.defineProperty(boundValue, \"prototype\", { value: value.prototype, enumerable: false, writable: true });\n    }\n    return boundValue;\n  }\n  return value;\n}\n\nexport function getDegradeIframe(id: string): HTMLIFrameElement {\n  return window.document.querySelector(`iframe[${WUJIE_APP_ID}=\"${id}\"]`);\n}\n\nexport function setAttrsToElement(element: HTMLElement, attrs: { [key: string]: any }) {\n  Object.keys(attrs).forEach((name) => {\n    element.setAttribute(name, attrs[name]);\n  });\n}\n\nexport function appRouteParse(url: string): {\n  urlElement: HTMLAnchorElement;\n  appHostPath: string;\n  appRoutePath: string;\n} {\n  if (!url) {\n    error(WUJIE_TIPS_NO_URL);\n    throw new Error();\n  }\n  const urlElement = anchorElementGenerator(url);\n  const appHostPath = urlElement.protocol + \"//\" + urlElement.host;\n  let appRoutePath = urlElement.pathname + urlElement.search + urlElement.hash;\n  if (!appRoutePath.startsWith(\"/\")) appRoutePath = \"/\" + appRoutePath; // hack ie\n  return { urlElement, appHostPath, appRoutePath };\n}\n\nexport function anchorElementGenerator(url: string): HTMLAnchorElement {\n  const element = window.document.createElement(\"a\");\n  element.href = url;\n  element.href = element.href; // hack ie\n  return element;\n}\n\nexport function getAnchorElementQueryMap(anchorElement: HTMLAnchorElement): { [key: string]: string } {\n  const queryList = anchorElement.search.replace(\"?\", \"\").split(\"&\");\n  const queryMap = {};\n  queryList.forEach((query) => {\n    const [key, value] = query.split(\"=\");\n    if (key && value) queryMap[key] = value;\n  });\n  return queryMap;\n}\n\n/**\n * urlid\n */\nexport function isMatchSyncQueryById(id: string): boolean {\n  const queryMap = getAnchorElementQueryMap(anchorElementGenerator(window.location.href));\n  return Object.keys(queryMap).includes(id);\n}\n\n/**\n * \n * @param iframeWindow\n */\nexport function fixElementCtrSrcOrHref(\n  iframeWindow: Window,\n  elementCtr:\n    | typeof HTMLImageElement\n    | typeof HTMLAnchorElement\n    | typeof HTMLSourceElement\n    | typeof HTMLLinkElement\n    | typeof HTMLScriptElement\n    | typeof HTMLMediaElement,\n  attr\n): void {\n  // patch setAttribute\n  const rawElementSetAttribute = iframeWindow.Element.prototype.setAttribute;\n  elementCtr.prototype.setAttribute = function (name: string, value: string): void {\n    let targetValue = value;\n    if (name === attr) targetValue = getAbsolutePath(value, this.baseURI || \"\", true);\n    rawElementSetAttribute.call(this, name, targetValue);\n  };\n  // patch href get and set\n  const rawAnchorElementHrefDescriptor = Object.getOwnPropertyDescriptor(elementCtr.prototype, attr);\n  const { enumerable, configurable, get, set } = rawAnchorElementHrefDescriptor;\n  Object.defineProperty(elementCtr.prototype, attr, {\n    enumerable,\n    configurable,\n    get: function () {\n      return get.call(this);\n    },\n    set: function (href) {\n      set.call(this, getAbsolutePath(href, this.baseURI, true));\n    },\n  });\n  // TODO: innerHTML\n}\n\nexport function getCurUrl(proxyLocation: Object): string {\n  const location = proxyLocation as Location;\n  return location.protocol + \"//\" + location.host + location.pathname;\n}\n\nexport function getAbsolutePath(url: string, base: string, hash?: boolean): string {\n  try {\n    // \n    if (url) {\n      // hash\n      if (hash && url.startsWith(\"#\")) return url;\n      return new URL(url, base).href;\n    } else return url;\n  } catch {\n    return url;\n  }\n}\n/**\n * url\n */\nexport function getSyncUrl(id: string, prefix: { [key: string]: string }): string {\n  let winUrlElement = anchorElementGenerator(window.location.href);\n  const queryMap = getAnchorElementQueryMap(winUrlElement);\n  winUrlElement = null;\n  const syncUrl = window.decodeURIComponent(queryMap[id] || \"\");\n  const validShortPath = syncUrl.match(/^{([^}]*)}/)?.[1];\n  if (prefix && validShortPath) {\n    return syncUrl.replace(`{${validShortPath}}`, prefix[validShortPath]);\n  }\n  return syncUrl;\n}\n// @ts-ignore\nexport const requestIdleCallback = window.requestIdleCallback || ((cb: Function) => setTimeout(cb, 1));\n\nexport function getContainer(container: string | HTMLElement): HTMLElement {\n  return typeof container === \"string\" ? (document.querySelector(container) as HTMLElement) : container;\n}\n\nexport function warn(msg: string, data?: any): void {\n  console?.warn(`[wujie warn]: ${msg}`, data);\n}\n\nexport function error(msg: string, data?: any): void {\n  console?.error(`[wujie error]: ${msg}`, data);\n}\n\nexport function getInlineCode(match) {\n  const start = match.indexOf(\">\") + 1;\n  const end = match.lastIndexOf(\"<\");\n  return match.substring(start, end);\n}\n\nexport function defaultGetPublicPath(entry) {\n  if (typeof entry === \"object\") {\n    return \"/\";\n  }\n  try {\n    const { origin, pathname } = new URL(entry, location.href);\n    const paths = pathname.split(\"/\");\n    // \n    paths.pop();\n    return `${origin}${paths.join(\"/\")}/`;\n  } catch (e) {\n    console.warn(e);\n    return \"\";\n  }\n}\n\n/** [f1, f2, f3, f4] => f4(f3(f2(f1)))  */\nexport function compose(fnList: Array<Function>): (...args: Array<string>) => string {\n  return function (code: string, ...args: Array<any>) {\n    return fnList.reduce((newCode, fn) => (isFunction(fn) ? fn(newCode, ...args) : newCode), code || \"\");\n  };\n}\n\n// \nexport function nextTick(cb: () => any): void {\n  Promise.resolve().then(cb);\n}\n\n//\nexport function execHooks(plugins: Array<plugin>, hookName: string, ...args: Array<any>): void {\n  try {\n    if (plugins && plugins.length > 0) {\n      plugins\n        .map((plugin) => plugin[hookName])\n        .filter((hook) => isFunction(hook))\n        .forEach((hook) => hook(...args));\n    }\n  } catch (e) {\n    error(e);\n  }\n}\n\nexport function isScriptElement(element: HTMLElement): boolean {\n  return element.tagName?.toUpperCase() === \"SCRIPT\";\n}\n\nlet count = 1;\nexport function setTagToScript(element: HTMLScriptElement, tag?: string): void {\n  if (isScriptElement(element)) {\n    const scriptTag = tag || String(count++);\n    element.setAttribute(WUJIE_SCRIPT_ID, scriptTag);\n  }\n}\n\nexport function getTagFromScript(element: HTMLScriptElement): string | null {\n  if (isScriptElement(element)) {\n    return element.getAttribute(WUJIE_SCRIPT_ID);\n  }\n  return null;\n}\n\n// \nexport function mergeOptions(options: cacheOptions, cacheOptions: cacheOptions) {\n  return {\n    name: options.name,\n    el: options.el || cacheOptions?.el,\n    url: options.url || cacheOptions?.url,\n    html: options.html || cacheOptions?.html,\n    exec: options.exec !== undefined ? options.exec : cacheOptions?.exec,\n    replace: options.replace || cacheOptions?.replace,\n    fetch: options.fetch || cacheOptions?.fetch,\n    props: options.props || cacheOptions?.props,\n    sync: options.sync !== undefined ? options.sync : cacheOptions?.sync,\n    prefix: options.prefix || cacheOptions?.prefix,\n    loading: options.loading || cacheOptions?.loading,\n    //  {}\n    attrs: options.attrs !== undefined ? options.attrs : cacheOptions?.attrs || {},\n    degradeAttrs: options.degradeAttrs !== undefined ? options.degradeAttrs : cacheOptions?.degradeAttrs || {},\n    //  true\n    fiber: options.fiber !== undefined ? options.fiber : cacheOptions?.fiber !== undefined ? cacheOptions?.fiber : true,\n    alive: options.alive !== undefined ? options.alive : cacheOptions?.alive,\n    degrade: options.degrade !== undefined ? options.degrade : cacheOptions?.degrade,\n    plugins: options.plugins || cacheOptions?.plugins,\n    lifecycles: {\n      beforeLoad: options.beforeLoad || cacheOptions?.beforeLoad,\n      beforeMount: options.beforeMount || cacheOptions?.beforeMount,\n      afterMount: options.afterMount || cacheOptions?.afterMount,\n      beforeUnmount: options.beforeUnmount || cacheOptions?.beforeUnmount,\n      afterUnmount: options.afterUnmount || cacheOptions?.afterUnmount,\n      activated: options.activated || cacheOptions?.activated,\n      deactivated: options.deactivated || cacheOptions?.deactivated,\n      loadError: options.loadError || cacheOptions?.loadError,\n    },\n  };\n}\n\n/**\n * \n */\nexport function eventTrigger(el: HTMLElement | Window | Document, eventName: string, detail?: any) {\n  let event;\n  if (typeof window.CustomEvent === \"function\") {\n    event = new CustomEvent(eventName, { detail });\n  } else {\n    event = document.createEvent(\"CustomEvent\");\n    event.initCustomEvent(eventName, true, false, detail);\n  }\n  el.dispatchEvent(event);\n}\n\nexport function stopMainAppRun() {\n  warn(WUJIE_TIPS_STOP_APP_DETAIL);\n  throw new Error(WUJIE_TIPS_STOP_APP);\n}\n","import { getInlineCode } from \"./utils\";\n\nconst ALL_SCRIPT_REGEX = /(<script[\\s\\S]*?>)[\\s\\S]*?<\\/script>/gi;\nconst SCRIPT_TAG_REGEX = /<(script)\\s+((?!type=('|\")text\\/ng-template\\3).)*?>.*?<\\/\\1>/is;\nconst SCRIPT_SRC_REGEX = /.*\\ssrc=('|\")?([^>'\"\\s]+)/;\nconst SCRIPT_TYPE_REGEX = /.*\\stype=('|\")?([^>'\"\\s]+)/;\nconst SCRIPT_ENTRY_REGEX = /.*\\sentry\\s*.*/;\nconst SCRIPT_ASYNC_REGEX = /.*\\sasync\\s*.*/;\nconst DEFER_ASYNC_REGEX = /.*\\sdefer\\s*.*/;\nconst SCRIPT_NO_MODULE_REGEX = /.*\\snomodule\\s*.*/;\nconst SCRIPT_MODULE_REGEX = /.*\\stype=('|\")?module('|\")?\\s*.*/;\nconst LINK_TAG_REGEX = /<(link)\\s+.*?>/gis;\nconst LINK_PRELOAD_OR_PREFETCH_REGEX = /\\srel=('|\")?(preload|prefetch|modulepreload)\\1/;\nconst LINK_HREF_REGEX = /.*\\shref=('|\")?([^>'\"\\s]+)/;\nconst LINK_AS_FONT = /.*\\sas=('|\")?font\\1.*/;\nconst STYLE_TAG_REGEX = /<style[^>]*>[\\s\\S]*?<\\/style>/gi;\nconst STYLE_TYPE_REGEX = /\\s+rel=('|\")?stylesheet\\1.*/;\nconst STYLE_HREF_REGEX = /.*\\shref=('|\")?([^>'\"\\s]+)/;\nconst HTML_COMMENT_REGEX = /<!--([\\s\\S]*?)-->/g;\nconst LINK_IGNORE_REGEX = /<link(\\s+|\\s+.+\\s+)ignore(\\s*|\\s+.*|=.*)>/is;\nconst STYLE_IGNORE_REGEX = /<style(\\s+|\\s+.+\\s+)ignore(\\s*|\\s+.*|=.*)>/is;\nconst SCRIPT_IGNORE_REGEX = /<script(\\s+|\\s+.+\\s+)ignore(\\s*|\\s+.*|=.*)>/is;\nconst CROSS_ORIGIN_REGEX = /.*\\scrossorigin=?('|\")?(use-credentials|anonymous)?('|\")?/i;\n\nexport type ScriptAttributes = {\n  [key: string]: string | boolean; // \n};\n/**  */\nexport interface ScriptBaseObject {\n  /**  */\n  src?: string;\n  /** async */\n  async?: boolean;\n  /** defer */\n  defer?: boolean;\n  /** module */\n  module?: boolean;\n  /** crossorigin */\n  crossorigin?: boolean;\n  /** crossorigin */\n  crossoriginType?: \"anonymous\" | \"use-credentials\" | \"\";\n  /**  */\n  attrs?: ScriptAttributes;\n}\nexport type ScriptObject = ScriptBaseObject & {\n  /** script */\n  content?: string;\n  /**  */\n  ignore?: boolean;\n  /**  */\n  onload?: Function;\n};\n\n/**  */\nexport interface StyleObject {\n  /**   */\n  src?: string;\n  /**  */\n  content?: string;\n  /**  */\n  ignore?: boolean;\n}\n\nexport interface TemplateResult {\n  template: string;\n  scripts: ScriptObject[];\n  styles: StyleObject[];\n  entry: string | ScriptObject;\n}\n\nfunction hasProtocol(url) {\n  return url.startsWith(\"//\") || url.startsWith(\"http://\") || url.startsWith(\"https://\");\n}\n\nfunction getEntirePath(path, baseURI) {\n  return new URL(path, baseURI).toString();\n}\n\nfunction isValidJavaScriptType(type) {\n  const handleTypes = [\n    \"text/javascript\",\n    \"module\",\n    \"application/javascript\",\n    \"text/ecmascript\",\n    \"application/ecmascript\",\n  ];\n  return !type || handleTypes.indexOf(type) !== -1;\n}\n\n/**\n * \n * @param scriptOuterHTML script  outerHTML\n * @returns  script \n */\nexport function parseTagAttributes(TagOuterHTML) {\n  const pattern = /<[-\\w]+\\s+([^>]*)>/i;\n  const matches = pattern.exec(TagOuterHTML);\n\n  if (!matches) {\n    return {};\n  }\n\n  const attributesString = matches[1];\n  const attributesPattern = /([^\\s=]+)\\s*=\\s*(['\"])(.*?)\\2/g;\n  const attributesObject = {};\n\n  let attributeMatches;\n  while ((attributeMatches = attributesPattern.exec(attributesString)) !== null) {\n    const attributeName = attributeMatches[1];\n    const attributeValue = attributeMatches[3];\n    attributesObject[attributeName] = attributeValue;\n  }\n\n  return attributesObject;\n}\n\nfunction isModuleScriptSupported() {\n  const s = window.document.createElement(\"script\");\n  return \"noModule\" in s;\n}\n\nexport const genLinkReplaceSymbol = (linkHref, preloadOrPrefetch = false) =>\n  `<!-- ${preloadOrPrefetch ? \"prefetch/preload/modulepreload\" : \"\"} link ${linkHref} replaced by wujie -->`;\nexport const getInlineStyleReplaceSymbol = (index) => `<!-- inline-style-${index} replaced by wujie -->`;\nexport const genScriptReplaceSymbol = (scriptSrc, type = \"\") =>\n  `<!-- ${type} script ${scriptSrc} replaced by wujie -->`;\nexport const inlineScriptReplaceSymbol = \"<!-- inline scripts replaced by wujie -->\";\nexport const genIgnoreAssetReplaceSymbol = (url) => `<!-- ignore asset ${url || \"file\"} replaced by wujie -->`;\nexport const genModuleScriptReplaceSymbol = (scriptSrc, moduleSupport) =>\n  `<!-- ${moduleSupport ? \"nomodule\" : \"module\"} script ${scriptSrc} ignored by wujie -->`;\n\n/**\n * parse the script link from the template\n * 1. collect stylesheets\n * 2. use global eval to evaluate the inline scripts\n *    see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function#Difference_between_Function_constructor_and_function_declaration\n *    see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval#Do_not_ever_use_eval!\n * @param tpl\n * @param baseURI\n * @stripStyles whether to strip the css links\n * @returns {{template: void | string | *, scripts: *[], entry: *}}\n */\nexport default function processTpl(tpl: String, baseURI: String, postProcessTemplate?: Function): TemplateResult {\n  const scripts: ScriptObject[] = [];\n  const styles: StyleObject[] = [];\n  let entry = null;\n  const moduleSupport = isModuleScriptSupported();\n  const template = tpl\n\n    /*\n     remove html comment first\n     */\n    .replace(HTML_COMMENT_REGEX, \"\")\n\n    .replace(LINK_TAG_REGEX, (match) => {\n      /*\n       change the css link\n       */\n      const styleType = !!match.match(STYLE_TYPE_REGEX);\n      if (styleType) {\n        const styleHref = match.match(STYLE_HREF_REGEX);\n        const styleIgnore = match.match(LINK_IGNORE_REGEX);\n\n        if (styleHref) {\n          const href = styleHref && styleHref[2];\n          let newHref = href;\n\n          if (href && !hasProtocol(href)) {\n            newHref = getEntirePath(href, baseURI);\n          }\n          if (styleIgnore) {\n            return genIgnoreAssetReplaceSymbol(newHref);\n          }\n\n          styles.push({ src: newHref });\n          return genLinkReplaceSymbol(newHref);\n        }\n      }\n\n      const preloadOrPrefetchType =\n        match.match(LINK_PRELOAD_OR_PREFETCH_REGEX) && match.match(LINK_HREF_REGEX) && !match.match(LINK_AS_FONT);\n      if (preloadOrPrefetchType) {\n        const [, , linkHref] = match.match(LINK_HREF_REGEX);\n        return genLinkReplaceSymbol(linkHref, true);\n      }\n\n      return match;\n    })\n    .replace(STYLE_TAG_REGEX, (match) => {\n      if (STYLE_IGNORE_REGEX.test(match)) {\n        return genIgnoreAssetReplaceSymbol(\"style file\");\n      } else {\n        const code = getInlineCode(match);\n        styles.push({ src: \"\", content: code });\n        return getInlineStyleReplaceSymbol(styles.length - 1);\n      }\n    })\n    .replace(ALL_SCRIPT_REGEX, (match, scriptTag) => {\n      const scriptIgnore = scriptTag.match(SCRIPT_IGNORE_REGEX);\n      const isModuleScript = !!scriptTag.match(SCRIPT_MODULE_REGEX);\n      const isCrossOriginScript = scriptTag.match(CROSS_ORIGIN_REGEX);\n      const crossOriginType = isCrossOriginScript?.[2] || \"\";\n      const moduleScriptIgnore =\n        (moduleSupport && !!scriptTag.match(SCRIPT_NO_MODULE_REGEX)) || (!moduleSupport && isModuleScript);\n      // in order to keep the exec order of all javascripts\n\n      const matchedScriptTypeMatch = scriptTag.match(SCRIPT_TYPE_REGEX);\n      const matchedScriptType = matchedScriptTypeMatch && matchedScriptTypeMatch[2];\n      if (!isValidJavaScriptType(matchedScriptType)) {\n        return match;\n      }\n\n      // if it is a external script\n      if (SCRIPT_TAG_REGEX.test(match) && scriptTag.match(SCRIPT_SRC_REGEX)) {\n        /*\n         collect scripts and replace the ref\n         */\n\n        const matchedScriptEntry = scriptTag.match(SCRIPT_ENTRY_REGEX);\n        const matchedScriptSrcMatch = scriptTag.match(SCRIPT_SRC_REGEX);\n        let matchedScriptSrc = matchedScriptSrcMatch && matchedScriptSrcMatch[2];\n\n        if (entry && matchedScriptEntry) {\n          throw new SyntaxError(\"You should not set multiply entry script!\");\n        } else {\n          // append the domain while the script not have an protocol prefix\n          if (matchedScriptSrc && !hasProtocol(matchedScriptSrc)) {\n            matchedScriptSrc = getEntirePath(matchedScriptSrc, baseURI);\n          }\n\n          entry = entry || (matchedScriptEntry && matchedScriptSrc);\n        }\n\n        if (scriptIgnore) {\n          return genIgnoreAssetReplaceSymbol(matchedScriptSrc || \"js file\");\n        }\n\n        if (moduleScriptIgnore) {\n          return genModuleScriptReplaceSymbol(matchedScriptSrc || \"js file\", moduleSupport);\n        }\n\n        if (matchedScriptSrc) {\n          const isAsyncScript = !!scriptTag.match(SCRIPT_ASYNC_REGEX);\n          const isDeferScript = !!scriptTag.match(DEFER_ASYNC_REGEX);\n          scripts.push(\n            isAsyncScript || isDeferScript\n              ? {\n                  async: isAsyncScript,\n                  defer: isDeferScript,\n                  src: matchedScriptSrc,\n                  module: isModuleScript,\n                  crossorigin: !!isCrossOriginScript,\n                  crossoriginType: crossOriginType,\n                  attrs: parseTagAttributes(match),\n                }\n              : {\n                  src: matchedScriptSrc,\n                  module: isModuleScript,\n                  crossorigin: !!isCrossOriginScript,\n                  crossoriginType: crossOriginType,\n                  attrs: parseTagAttributes(match),\n                }\n          );\n          return genScriptReplaceSymbol(\n            matchedScriptSrc,\n            (isAsyncScript && \"async\") || (isDeferScript && \"defer\") || \"\"\n          );\n        }\n\n        return match;\n      } else {\n        if (scriptIgnore) {\n          return genIgnoreAssetReplaceSymbol(\"js file\");\n        }\n\n        if (moduleScriptIgnore) {\n          return genModuleScriptReplaceSymbol(\"js file\", moduleSupport);\n        }\n\n        // if it is an inline script\n        const code = getInlineCode(match);\n\n        // remove script blocks when all of these lines are comments.\n        const isPureCommentBlock = code.split(/[\\r\\n]+/).every((line) => !line.trim() || line.trim().startsWith(\"//\"));\n\n        if (!isPureCommentBlock && code) {\n          scripts.push({\n            src: \"\",\n            content: code,\n            module: isModuleScript,\n            crossorigin: !!isCrossOriginScript,\n            crossoriginType: crossOriginType,\n            attrs: parseTagAttributes(match),\n          });\n        }\n\n        return inlineScriptReplaceSymbol;\n      }\n    });\n\n  let tplResult = {\n    template,\n    scripts,\n    styles,\n    // set the last script as entry if have not set\n    entry: entry || scripts[scripts.length - 1],\n  };\n  if (typeof postProcessTemplate === \"function\") {\n    tplResult = postProcessTemplate(tplResult);\n  }\n\n  return tplResult;\n}\n","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import { plugin, ScriptObjectLoader } from \"./index\";\nimport { StyleObject } from \"./template\";\nimport { compose, getAbsolutePath } from \"./utils\";\n\ninterface loaderOption {\n  plugins: Array<plugin>;\n  replace: (code: string) => string;\n}\n\n/**\n *  cssLoader\n */\nexport function getCssLoader({ plugins, replace }: loaderOption) {\n  return (code: string, src: string = \"\", base: string): string =>\n    compose(plugins.map((plugin) => plugin.cssLoader))(replace ? replace(code) : code, src, base);\n}\n\n/**\n *  jsLoader\n */\nexport function getJsLoader({ plugins, replace }: loaderOption) {\n  return (code: string, src: string = \"\", base: string): string =>\n    compose(plugins.map((plugin) => plugin.jsLoader))(replace ? replace(code) : code, src, base);\n}\n\n/**\n * \n */\ntype presetLoadersType = \"cssBeforeLoaders\" | \"cssAfterLoaders\" | \"jsBeforeLoaders\" | \"jsAfterLoaders\";\nexport function getPresetLoaders(loaderType: presetLoadersType, plugins: Array<plugin>): plugin[presetLoadersType] {\n  const loaders: (StyleObject | ScriptObjectLoader)[][] = plugins\n    .map((plugin) => plugin[loaderType])\n    .filter((loaders) => loaders?.length);\n  const res = loaders.reduce((preLoaders, curLoaders) => preLoaders.concat(curLoaders), []);\n  return loaderType === \"cssBeforeLoaders\" ? res.reverse() : res;\n}\n\n/**\n * \n */\ntype effectLoadersType = \"jsExcludes\" | \"cssExcludes\" | \"jsIgnores\" | \"cssIgnores\";\nexport function getEffectLoaders(loaderType: effectLoadersType, plugins: Array<plugin>): plugin[effectLoadersType] {\n  return plugins\n    .map((plugin) => plugin[loaderType])\n    .filter((loaders) => loaders?.length)\n    .reduce((preLoaders, curLoaders) => preLoaders.concat(curLoaders), []);\n}\n\n//  url loader\nexport function isMatchUrl(url: string, effectLoaders: plugin[effectLoadersType]): boolean {\n  return effectLoaders.some((loader) => (typeof loader === \"string\" ? url === loader : loader.test(url)));\n}\n\n/**\n * css\n */\nfunction cssRelativePathResolve(code: string, src: string, base: string) {\n  const baseUrl = src ? getAbsolutePath(src, base) : base;\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/url\n  const urlReg = /(url\\((?!['\"]?(?:data):)['\"]?)([^'\")]*)(['\"]?\\))/g;\n  return code.replace(urlReg, (_m, pre, url, post) => {\n    const absoluteUrl = getAbsolutePath(url, baseUrl);\n    return pre + absoluteUrl + post;\n  });\n}\n\nconst defaultPlugin = {\n  cssLoader: cssRelativePathResolve,\n  // fix https://github.com/Tencent/wujie/issues/455\n  cssBeforeLoaders: [{ content: \"html {view-transition-name: none;}\" }],\n};\n\nexport function getPlugins(plugins: Array<plugin>): Array<plugin> {\n  return Array.isArray(plugins) ? [defaultPlugin, ...plugins] : [defaultPlugin];\n}\n\nexport default defaultPlugin;\n","import processTpl, {\n  genLinkReplaceSymbol,\n  getInlineStyleReplaceSymbol,\n  ScriptObject,\n  ScriptBaseObject,\n  StyleObject,\n} from \"./template\";\nimport { defaultGetPublicPath, getInlineCode, requestIdleCallback, error, compose, getCurUrl } from \"./utils\";\nimport {\n  WUJIE_TIPS_NO_FETCH,\n  WUJIE_TIPS_SCRIPT_ERROR_REQUESTED,\n  WUJIE_TIPS_CSS_ERROR_REQUESTED,\n  WUJIE_TIPS_HTML_ERROR_REQUESTED,\n} from \"./constant\";\nimport { getEffectLoaders, isMatchUrl } from \"./plugin\";\nimport Wujie from \"./sandbox\";\nimport { plugin, loadErrorHandler } from \"./index\";\n\nexport type ScriptResultList = (ScriptBaseObject & { contentPromise: Promise<string> })[];\nexport type StyleResultList = { src: string; contentPromise: Promise<string>; ignore?: boolean }[];\n\ninterface htmlParseResult {\n  template: string;\n\n  assetPublicPath: string;\n\n  getExternalScripts(): ScriptResultList;\n\n  getExternalStyleSheets(): StyleResultList;\n}\n\ntype ImportEntryOpts = {\n  fetch?: typeof window.fetch;\n  fiber?: boolean;\n  plugins?: Array<plugin>;\n  loadError?: loadErrorHandler;\n};\n\nconst styleCache = {};\nconst scriptCache = {};\nconst embedHTMLCache = {};\n\nif (!window.fetch) {\n  error(WUJIE_TIPS_NO_FETCH);\n  throw new Error();\n}\nconst defaultFetch = window.fetch.bind(window);\n\nfunction defaultGetTemplate(tpl) {\n  return tpl;\n}\n\n/**\n * css-loader\n */\nexport async function processCssLoader(\n  sandbox: Wujie,\n  template: string,\n  getExternalStyleSheets: () => StyleResultList\n): Promise<string> {\n  const curUrl = getCurUrl(sandbox.proxyLocation);\n  /** css-loader */\n  const composeCssLoader = compose(sandbox.plugins.map((plugin) => plugin.cssLoader));\n  const processedCssList: StyleResultList = getExternalStyleSheets().map(({ src, ignore, contentPromise }) => ({\n    src,\n    ignore,\n    contentPromise: contentPromise.then((content) => composeCssLoader(content, src, curUrl)),\n  }));\n  const embedHTML = await getEmbedHTML(template, processedCssList);\n  return sandbox.replace ? sandbox.replace(embedHTML) : embedHTML;\n}\n\n/**\n * convert external css link to inline style for performance optimization\n * @return embedHTML\n */\nasync function getEmbedHTML(template, styleResultList: StyleResultList): Promise<string> {\n  let embedHTML = template;\n\n  return Promise.all(\n    styleResultList.map((styleResult, index) =>\n      styleResult.contentPromise.then((content) => {\n        if (styleResult.src) {\n          embedHTML = embedHTML.replace(\n            genLinkReplaceSymbol(styleResult.src),\n            styleResult.ignore\n              ? `<link href=\"${styleResult.src}\" rel=\"stylesheet\" type=\"text/css\">`\n              : `<style>/* ${styleResult.src} */${content}</style>`\n          );\n        } else if (content) {\n          embedHTML = embedHTML.replace(\n            getInlineStyleReplaceSymbol(index),\n            `<style>/* inline-style-${index} */${content}</style>`\n          );\n        }\n      })\n    )\n  ).then(() => embedHTML);\n}\n\nconst isInlineCode = (code) => code.startsWith(\"<\");\n\nconst fetchAssets = (\n  src: string,\n  cache: Object,\n  fetch: (input: RequestInfo, init?: RequestInit) => Promise<Response>,\n  cssFlag?: boolean,\n  loadError?: loadErrorHandler\n) =>\n  cache[src] ||\n  (cache[src] = fetch(src)\n    .then((response) => {\n      // usually browser treats 4xx and 5xx response of script loading as an error and will fire a script error event\n      // https://stackoverflow.com/questions/5625420/what-http-headers-responses-trigger-the-onerror-handler-on-a-script-tag/5625603\n      if (response.status >= 400) {\n        cache[src] = null;\n        if (cssFlag) {\n          error(WUJIE_TIPS_CSS_ERROR_REQUESTED, { src, response });\n          loadError?.(src, new Error(WUJIE_TIPS_CSS_ERROR_REQUESTED));\n          return \"\";\n        } else {\n          error(WUJIE_TIPS_SCRIPT_ERROR_REQUESTED, { src, response });\n          loadError?.(src, new Error(WUJIE_TIPS_SCRIPT_ERROR_REQUESTED));\n          throw new Error(WUJIE_TIPS_SCRIPT_ERROR_REQUESTED);\n        }\n      }\n      return response.text();\n    })\n    .catch((e) => {\n      cache[src] = null;\n      if (cssFlag) {\n        error(WUJIE_TIPS_CSS_ERROR_REQUESTED, src);\n        loadError?.(src, e);\n        return \"\";\n      } else {\n        error(WUJIE_TIPS_SCRIPT_ERROR_REQUESTED, src);\n        loadError?.(src, e);\n        return \"\";\n      }\n    }));\n\n// for prefetch\nexport function getExternalStyleSheets(\n  styles: StyleObject[],\n  fetch: (input: RequestInfo, init?: RequestInit) => Promise<Response> = defaultFetch,\n  loadError: loadErrorHandler\n): StyleResultList {\n  return styles.map(({ src, content, ignore }) => {\n    // \n    if (content) {\n      return { src: \"\", contentPromise: Promise.resolve(content) };\n    } else if (isInlineCode(src)) {\n      // if it is inline style\n      return { src: \"\", contentPromise: Promise.resolve(getInlineCode(src)) };\n    } else {\n      // external styles\n      return {\n        src,\n        ignore,\n        contentPromise: ignore ? Promise.resolve(\"\") : fetchAssets(src, styleCache, fetch, true, loadError),\n      };\n    }\n  });\n}\n\n// for prefetch\nexport function getExternalScripts(\n  scripts: ScriptObject[],\n  fetch: (input: RequestInfo, init?: RequestInit) => Promise<Response> = defaultFetch,\n  loadError: loadErrorHandler,\n  fiber: boolean\n): ScriptResultList {\n  // module should be requested in iframe\n  return scripts.map((script) => {\n    const { src, async, defer, module, ignore } = script;\n    let contentPromise = null;\n    // async\n    if ((async || defer) && src && !module) {\n      contentPromise = new Promise((resolve, reject) =>\n        fiber\n          ? requestIdleCallback(() => fetchAssets(src, scriptCache, fetch, false, loadError).then(resolve, reject))\n          : fetchAssets(src, scriptCache, fetch, false, loadError).then(resolve, reject)\n      );\n      // module || ignore\n    } else if ((module && src) || ignore) {\n      contentPromise = Promise.resolve(\"\");\n      // inline\n    } else if (!src) {\n      contentPromise = Promise.resolve(script.content);\n      // outline\n    } else {\n      contentPromise = fetchAssets(src, scriptCache, fetch, false, loadError);\n    }\n    // refer https://html.spec.whatwg.org/multipage/scripting.html#attr-script-defer\n    if (module && !async) script.defer = true;\n    return { ...script, contentPromise };\n  });\n}\n\nexport default function importHTML(params: {\n  url: string;\n  html?: string;\n  opts: ImportEntryOpts;\n}): Promise<htmlParseResult> {\n  const { url, opts, html } = params;\n  const fetch = opts.fetch ?? defaultFetch;\n  const fiber = opts.fiber ?? true;\n  const { plugins, loadError } = opts;\n  const htmlLoader = plugins ? compose(plugins.map((plugin) => plugin.htmlLoader)) : defaultGetTemplate;\n  const jsExcludes = getEffectLoaders(\"jsExcludes\", plugins);\n  const cssExcludes = getEffectLoaders(\"cssExcludes\", plugins);\n  const jsIgnores = getEffectLoaders(\"jsIgnores\", plugins);\n  const cssIgnores = getEffectLoaders(\"cssIgnores\", plugins);\n  const getPublicPath = defaultGetPublicPath;\n\n  const getHtmlParseResult = (url, html, htmlLoader) =>\n    (html\n      ? Promise.resolve(html)\n      : fetch(url)\n          .then((response) => {\n            if (response.status >= 400) {\n              error(WUJIE_TIPS_HTML_ERROR_REQUESTED, { url, response });\n              loadError?.(url, new Error(WUJIE_TIPS_HTML_ERROR_REQUESTED));\n              return \"\";\n            }\n            return response.text();\n          })\n          .catch((e) => {\n            embedHTMLCache[url] = null;\n            loadError?.(url, e);\n            return Promise.reject(e);\n          })\n    ).then((html) => {\n      const assetPublicPath = getPublicPath(url);\n      const { template, scripts, styles } = processTpl(htmlLoader(html), assetPublicPath);\n      return {\n        template: template,\n        assetPublicPath,\n        getExternalScripts: () =>\n          getExternalScripts(\n            scripts\n              .filter((script) => !script.src || !isMatchUrl(script.src, jsExcludes))\n              .map((script) => ({ ...script, ignore: script.src && isMatchUrl(script.src, jsIgnores) })),\n            fetch,\n            loadError,\n            fiber\n          ),\n        getExternalStyleSheets: () =>\n          getExternalStyleSheets(\n            styles\n              .filter((style) => !style.src || !isMatchUrl(style.src, cssExcludes))\n              .map((style) => ({ ...style, ignore: style.src && isMatchUrl(style.src, cssIgnores) })),\n            fetch,\n            loadError\n          ),\n      };\n    });\n\n  if (opts?.plugins.some((plugin) => plugin.htmlLoader)) {\n    return getHtmlParseResult(url, html, htmlLoader);\n    // html-loader\n  } else {\n    return embedHTMLCache[url] || (embedHTMLCache[url] = getHtmlParseResult(url, html, htmlLoader));\n  }\n}\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","import Wujie from \"./sandbox\";\nimport { cacheOptions } from \"./index\";\nexport interface SandboxCache {\n  wujie?: Wujie;\n  options?: cacheOptions;\n}\n\nexport type appAddEventListenerOptions = AddEventListenerOptions & { targetWindow?: Window };\n\n// map\nexport const idToSandboxCacheMap = window.__POWERED_BY_WUJIE__\n  ? window.__WUJIE.inject.idToSandboxMap\n  : new Map<String, SandboxCache>();\n\nexport function getWujieById(id: String): Wujie | null {\n  return idToSandboxCacheMap.get(id)?.wujie || null;\n}\n\nexport function getOptionsById(id: String): cacheOptions | null {\n  return idToSandboxCacheMap.get(id)?.options || null;\n}\n\nexport function addSandboxCacheWithWujie(id: string, sandbox: Wujie): void {\n  const wujieCache = idToSandboxCacheMap.get(id);\n  if (wujieCache) idToSandboxCacheMap.set(id, { ...wujieCache, wujie: sandbox });\n  else idToSandboxCacheMap.set(id, { wujie: sandbox });\n}\n\nexport function deleteWujieById(id: string) {\n  const wujieCache = idToSandboxCacheMap.get(id);\n  if (wujieCache?.options) idToSandboxCacheMap.set(id, { options: wujieCache.options });\n  idToSandboxCacheMap.delete(id);\n}\n\nexport function addSandboxCacheWithOptions(id: string, options: cacheOptions): void {\n  const wujieCache = idToSandboxCacheMap.get(id);\n  if (wujieCache) idToSandboxCacheMap.set(id, { ...wujieCache, options });\n  else idToSandboxCacheMap.set(id, { options });\n}\n\n// document\nexport const documentProxyProperties = {\n  // \n  modifyLocalProperties: [\"createElement\", \"createTextNode\", \"documentURI\", \"URL\", \"getElementsByTagName\"],\n\n  // \n  modifyProperties: [\n    \"createElement\",\n    \"createTextNode\",\n    \"documentURI\",\n    \"URL\",\n    \"getElementsByTagName\",\n    \"getElementsByClassName\",\n    \"getElementsByName\",\n    \"getElementById\",\n    \"querySelector\",\n    \"querySelectorAll\",\n    \"documentElement\",\n    \"scrollingElement\",\n    \"forms\",\n    \"images\",\n    \"links\",\n  ],\n\n  // shadowRoot\n  shadowProperties: [\n    \"activeElement\",\n    \"childElementCount\",\n    \"children\",\n    \"firstElementChild\",\n    \"firstChild\",\n    \"fullscreenElement\",\n    \"lastElementChild\",\n    \"pictureInPictureElement\",\n    \"pointerLockElement\",\n    \"styleSheets\",\n  ],\n\n  // shadowRoot\n  shadowMethods: [\n    \"append\",\n    \"contains\",\n    \"getSelection\",\n    \"elementFromPoint\",\n    \"elementsFromPoint\",\n    \"getAnimations\",\n    \"replaceChildren\",\n  ],\n\n  // document\n  documentProperties: [\n    \"characterSet\",\n    \"compatMode\",\n    \"contentType\",\n    \"designMode\",\n    \"dir\",\n    \"doctype\",\n    \"embeds\",\n    \"fullscreenEnabled\",\n    \"hidden\",\n    \"implementation\",\n    \"lastModified\",\n    \"pictureInPictureEnabled\",\n    \"plugins\",\n    \"readyState\",\n    \"referrer\",\n    \"visibilityState\",\n    \"fonts\",\n  ],\n\n  // document\n  documentMethods: [\n    \"execCommand\",\n    \"createRange\",\n    \"exitFullscreen\",\n    \"exitPictureInPicture\",\n    \"getElementsByTagNameNS\",\n    \"hasFocus\",\n    \"prepend\",\n  ],\n\n  // document\n  documentEvents: [\n    \"onpointerlockchange\",\n    \"onpointerlockerror\",\n    \"onbeforecopy\",\n    \"onbeforecut\",\n    \"onbeforepaste\",\n    \"onfreeze\",\n    \"onresume\",\n    \"onsearch\",\n    \"onfullscreenchange\",\n    \"onfullscreenerror\",\n    \"onsecuritypolicyviolation\",\n    \"onvisibilitychange\",\n  ],\n\n  // \n  ownerProperties: [\"head\", \"body\"],\n};\n\n// iframe document\nexport const appDocumentAddEventListenerEvents = [\"DOMContentLoaded\", \"readystatechange\"];\nexport const appDocumentOnEvents = [\"onreadystatechange\"];\n// document\nexport const mainDocumentAddEventListenerEvents = [\n  \"fullscreenchange\",\n  \"fullscreenerror\",\n  \"selectionchange\",\n  \"visibilitychange\",\n  \"wheel\",\n  \"keydown\",\n  \"keypress\",\n  \"keyup\",\n];\n\n// documentshadow\nexport const mainAndAppAddEventListenerEvents = [\"gotpointercapture\", \"lostpointercapture\"];\n\n// windowiframe\nexport const appWindowAddEventListenerEvents = [\n  \"hashchange\",\n  \"popstate\",\n  \"DOMContentLoaded\",\n  \"load\",\n  \"beforeunload\",\n  \"unload\",\n  \"message\",\n];\n\n// window.onXXXiframe\nexport const appWindowOnEvent = [\"onload\", \"onbeforeunload\", \"onunload\"];\n\n// tagattrmap\nexport const relativeElementTagAttrMap = {\n  IMG: \"src\",\n  A: \"href\",\n  SOURCE: \"src\",\n};\n\n// window\nexport const windowProxyProperties = [\"getComputedStyle\", \"visualViewport\", \"matchMedia\", \"DOMParser\"];\n\n// window\nexport const windowRegWhiteList = [\n  /animationFrame$/i,\n  /resizeObserver$|mutationObserver$|intersectionObserver$/i,\n  /height$|width$|left$/i,\n  /^screen/i,\n  /X$|Y$/,\n];\n\n// \n// Document.prototype\nexport const rawElementAppendChild = HTMLElement.prototype.appendChild;\nexport const rawElementRemoveChild = HTMLElement.prototype.removeChild;\nexport const rawElementContains = HTMLElement.prototype.contains;\nexport const rawHeadInsertBefore = HTMLHeadElement.prototype.insertBefore;\nexport const rawBodyInsertBefore = HTMLBodyElement.prototype.insertBefore;\nexport const rawAddEventListener = Node.prototype.addEventListener;\nexport const rawRemoveEventListener = Node.prototype.removeEventListener;\nexport const rawWindowAddEventListener = window.addEventListener;\nexport const rawWindowRemoveEventListener = window.removeEventListener;\nexport const rawAppendChild = Node.prototype.appendChild;\nexport const rawDocumentQuerySelector = window.__POWERED_BY_WUJIE__\n  ? window.__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR__\n  : Document.prototype.querySelector;\n","import { getExternalStyleSheets, getExternalScripts } from \"./entry\";\nimport {\n  getWujieById,\n  rawAppendChild,\n  rawElementContains,\n  rawElementRemoveChild,\n  rawHeadInsertBefore,\n  rawBodyInsertBefore,\n  rawDocumentQuerySelector,\n  rawAddEventListener,\n  rawRemoveEventListener,\n} from \"./common\";\nimport {\n  isFunction,\n  isHijackingTag,\n  requestIdleCallback,\n  warn,\n  nextTick,\n  getCurUrl,\n  execHooks,\n  isScriptElement,\n  setTagToScript,\n  getTagFromScript,\n  setAttrsToElement,\n} from \"./utils\";\nimport { insertScriptToIframe, patchElementEffect } from \"./iframe\";\nimport Wujie from \"./sandbox\";\nimport { getPatchStyleElements } from \"./shadow\";\nimport { getCssLoader, getEffectLoaders, isMatchUrl } from \"./plugin\";\nimport { WUJIE_SCRIPT_ID, WUJIE_DATA_FLAG, WUJIE_TIPS_REPEAT_RENDER, WUJIE_TIPS_NO_SCRIPT } from \"./constant\";\nimport { ScriptObject, parseTagAttributes } from \"./template\";\n\nfunction patchCustomEvent(\n  e: CustomEvent,\n  elementGetter: () => HTMLScriptElement | HTMLLinkElement | null\n): CustomEvent {\n  Object.defineProperties(e, {\n    srcElement: {\n      get: elementGetter,\n    },\n    target: {\n      get: elementGetter,\n    },\n  });\n\n  return e;\n}\n\n/**\n * \n */\nfunction manualInvokeElementEvent(element: HTMLLinkElement | HTMLScriptElement, event: string): void {\n  const customEvent = new CustomEvent(event);\n  const patchedEvent = patchCustomEvent(customEvent, () => element);\n  if (isFunction(element[`on${event}`])) {\n    element[`on${event}`](patchedEvent);\n  } else {\n    element.dispatchEvent(patchedEvent);\n  }\n}\n\n/**\n * cssstylesheetElement\n */\nfunction handleStylesheetElementPatch(stylesheetElement: HTMLStyleElement & { _patcher?: any }, sandbox: Wujie) {\n  if (!stylesheetElement.innerHTML || sandbox.degrade) return;\n  const patcher = () => {\n    const [hostStyleSheetElement, fontStyleSheetElement] = getPatchStyleElements([stylesheetElement.sheet]);\n    if (hostStyleSheetElement) {\n      sandbox.shadowRoot.head.appendChild(hostStyleSheetElement);\n    }\n    if (fontStyleSheetElement) {\n      sandbox.shadowRoot.host.appendChild(fontStyleSheetElement);\n    }\n    stylesheetElement._patcher = undefined;\n  };\n  if (stylesheetElement._patcher) {\n    clearTimeout(stylesheetElement._patcher);\n  }\n  stylesheetElement._patcher = setTimeout(patcher, 50);\n}\n\n/**\n * \n */\nfunction patchStylesheetElement(\n  stylesheetElement: HTMLStyleElement & { _hasPatchStyle?: boolean },\n  cssLoader: (code: string, url: string, base: string) => string,\n  sandbox: Wujie,\n  curUrl: string\n) {\n  if (stylesheetElement._hasPatchStyle) return;\n  const innerHTMLDesc = Object.getOwnPropertyDescriptor(Element.prototype, \"innerHTML\");\n  const innerTextDesc = Object.getOwnPropertyDescriptor(HTMLElement.prototype, \"innerText\");\n  const textContentDesc = Object.getOwnPropertyDescriptor(Node.prototype, \"textContent\");\n  const RawInsertRule = stylesheetElement.sheet?.insertRule;\n  // cssRuleinnerHTML\n  function patchSheetInsertRule() {\n    if (!RawInsertRule) return;\n    stylesheetElement.sheet.insertRule = (rule: string, index?: number): number => {\n      innerHTMLDesc ? (stylesheetElement.innerHTML += rule) : (stylesheetElement.innerText += rule);\n      return RawInsertRule.call(stylesheetElement.sheet, rule, index);\n    };\n  }\n  patchSheetInsertRule();\n\n  if (innerHTMLDesc) {\n    Object.defineProperties(stylesheetElement, {\n      innerHTML: {\n        get: function () {\n          return innerHTMLDesc.get.call(stylesheetElement);\n        },\n        set: function (code: string) {\n          innerHTMLDesc.set.call(stylesheetElement, cssLoader(code, \"\", curUrl));\n          nextTick(() => handleStylesheetElementPatch(this, sandbox));\n        },\n      },\n    });\n  }\n\n  Object.defineProperties(stylesheetElement, {\n    innerText: {\n      get: function () {\n        return innerTextDesc.get.call(stylesheetElement);\n      },\n      set: function (code: string) {\n        innerTextDesc.set.call(stylesheetElement, cssLoader(code, \"\", curUrl));\n        nextTick(() => handleStylesheetElementPatch(this, sandbox));\n      },\n    },\n    textContent: {\n      get: function () {\n        return textContentDesc.get.call(stylesheetElement);\n      },\n      set: function (code: string) {\n        textContentDesc.set.call(stylesheetElement, cssLoader(code, \"\", curUrl));\n        nextTick(() => handleStylesheetElementPatch(this, sandbox));\n      },\n    },\n    appendChild: {\n      value: function (node: Node): Node {\n        nextTick(() => handleStylesheetElementPatch(this, sandbox));\n        if (node.nodeType === Node.TEXT_NODE) {\n          const res = rawAppendChild.call(\n            stylesheetElement,\n            stylesheetElement.ownerDocument.createTextNode(cssLoader(node.textContent, \"\", curUrl))\n          );\n          // appendChildsheetpatch\n          patchSheetInsertRule();\n          return res;\n        } else return rawAppendChild(node);\n      },\n    },\n    _hasPatchStyle: { get: () => true },\n  });\n}\n\nlet dynamicScriptExecStack = Promise.resolve();\nfunction rewriteAppendOrInsertChild(opts: {\n  rawDOMAppendOrInsertBefore: <T extends Node>(newChild: T, refChild?: Node | null) => T;\n  wujieId: string;\n}) {\n  return function appendChildOrInsertBefore<T extends Node>(\n    this: HTMLHeadElement | HTMLBodyElement,\n    newChild: T,\n    refChild?: Node | null\n  ) {\n    let element = newChild as any;\n    const { rawDOMAppendOrInsertBefore, wujieId } = opts;\n    const sandbox = getWujieById(wujieId);\n\n    const { styleSheetElements, replace, fetch, plugins, iframe, lifecycles, proxyLocation, fiber } = sandbox;\n\n    if (!isHijackingTag(element.tagName) || !wujieId) {\n      const res = rawDOMAppendOrInsertBefore.call(this, element, refChild) as T;\n      patchElementEffect(element, iframe.contentWindow);\n      execHooks(plugins, \"appendOrInsertElementHook\", element, iframe.contentWindow);\n      return res;\n    }\n\n    const iframeDocument = iframe.contentDocument;\n    const curUrl = getCurUrl(proxyLocation);\n\n    // TODO \n    if (element.tagName) {\n      switch (element.tagName?.toUpperCase()) {\n        case \"LINK\": {\n          const { href, rel, type } = element as HTMLLinkElement;\n          const styleFlag = rel === \"stylesheet\" || type === \"text/css\" || href.endsWith(\".css\");\n          //  stylesheet \n          if (!styleFlag) {\n            const res = rawDOMAppendOrInsertBefore.call(this, element, refChild);\n            execHooks(plugins, \"appendOrInsertElementHook\", element, iframe.contentWindow);\n            return res;\n          }\n          // css\n          if (href && !isMatchUrl(href, getEffectLoaders(\"cssExcludes\", plugins))) {\n            getExternalStyleSheets(\n              [{ src: href, ignore: isMatchUrl(href, getEffectLoaders(\"cssIgnores\", plugins)) }],\n              fetch,\n              lifecycles.loadError\n            ).forEach(({ src, ignore, contentPromise }) =>\n              contentPromise.then(\n                (content) => {\n                  //  ignore \n                  const rawAttrs = parseTagAttributes(element.outerHTML);\n                  if (ignore && src) {\n                    const stylesheetElement = iframeDocument.createElement(\"link\");\n                    const attrs = {\n                      ...rawAttrs,\n                      type: \"text/css\",\n                      rel: \"stylesheet\",\n                      href: src,\n                    };\n                    setAttrsToElement(stylesheetElement, attrs);\n                    rawDOMAppendOrInsertBefore.call(this, stylesheetElement, refChild);\n                    manualInvokeElementEvent(element, \"load\");\n                  } else {\n                    // js\n                    const stylesheetElement = iframeDocument.createElement(\"style\");\n                    // css-loader\n                    const cssLoader = getCssLoader({ plugins, replace });\n                    stylesheetElement.innerHTML = cssLoader(content, src, curUrl);\n                    styleSheetElements.push(stylesheetElement);\n                    setAttrsToElement(stylesheetElement, rawAttrs);\n                    rawDOMAppendOrInsertBefore.call(this, stylesheetElement, refChild);\n                    // \n                    handleStylesheetElementPatch(stylesheetElement, sandbox);\n                    manualInvokeElementEvent(element, \"load\");\n                  }\n                  element = null;\n                },\n                () => {\n                  manualInvokeElementEvent(element, \"error\");\n                  element = null;\n                }\n              )\n            );\n          }\n\n          const comment = iframeDocument.createComment(`dynamic link ${href} replaced by wujie`);\n          return rawDOMAppendOrInsertBefore.call(this, comment, refChild);\n        }\n        case \"STYLE\": {\n          const stylesheetElement: HTMLStyleElement = newChild as any;\n          styleSheetElements.push(stylesheetElement);\n          const content = stylesheetElement.innerHTML;\n          const cssLoader = getCssLoader({ plugins, replace });\n          content && (stylesheetElement.innerHTML = cssLoader(content, \"\", curUrl));\n          const res = rawDOMAppendOrInsertBefore.call(this, element, refChild);\n          // \n          patchStylesheetElement(stylesheetElement, cssLoader, sandbox, curUrl);\n          handleStylesheetElementPatch(stylesheetElement, sandbox);\n          execHooks(plugins, \"appendOrInsertElementHook\", element, iframe.contentWindow);\n          return res;\n        }\n        case \"SCRIPT\": {\n          setTagToScript(element);\n          const { src, text, type, crossOrigin } = element as HTMLScriptElement;\n          // js\n          if (src && !isMatchUrl(src, getEffectLoaders(\"jsExcludes\", plugins))) {\n            const execScript = (scriptResult: ScriptObject) => {\n              // \n              if (sandbox.iframe === null) return warn(WUJIE_TIPS_REPEAT_RENDER);\n              const onload = () => {\n                manualInvokeElementEvent(element, \"load\");\n                element = null;\n              };\n              insertScriptToIframe({ ...scriptResult, onload }, sandbox.iframe.contentWindow, element);\n            };\n            const scriptOptions = {\n              src,\n              module: type === \"module\",\n              crossorigin: crossOrigin !== null,\n              crossoriginType: crossOrigin || \"\",\n              ignore: isMatchUrl(src, getEffectLoaders(\"jsIgnores\", plugins)),\n              attrs: parseTagAttributes(element.outerHTML),\n            } as ScriptObject;\n            getExternalScripts([scriptOptions], fetch, lifecycles.loadError, fiber).forEach((scriptResult) => {\n              dynamicScriptExecStack = dynamicScriptExecStack.then(() =>\n                scriptResult.contentPromise.then(\n                  (content) => {\n                    if (sandbox.execQueue === null) return warn(WUJIE_TIPS_REPEAT_RENDER);\n                    const execQueueLength = sandbox.execQueue?.length;\n                    sandbox.execQueue.push(() =>\n                      fiber\n                        ? requestIdleCallback(() => {\n                            execScript({ ...scriptResult, content });\n                          })\n                        : execScript({ ...scriptResult, content })\n                    );\n                    // \n                    if (!execQueueLength) sandbox.execQueue.shift()();\n                  },\n                  () => {\n                    manualInvokeElementEvent(element, \"error\");\n                    element = null;\n                  }\n                )\n              );\n            });\n          } else {\n            const execQueueLength = sandbox.execQueue?.length;\n            sandbox.execQueue.push(() =>\n              fiber\n                ? requestIdleCallback(() => {\n                    insertScriptToIframe(\n                      { src: null, content: text, attrs: parseTagAttributes(element.outerHTML) },\n                      sandbox.iframe.contentWindow,\n                      element\n                    );\n                  })\n                : insertScriptToIframe(\n                    { src: null, content: text, attrs: parseTagAttributes(element.outerHTML) },\n                    sandbox.iframe.contentWindow,\n                    element\n                  )\n            );\n            if (!execQueueLength) sandbox.execQueue.shift()();\n          }\n          // inline script never trigger the onload and onerror event\n          const comment = iframeDocument.createComment(`dynamic script ${src} replaced by wujie`);\n          return rawDOMAppendOrInsertBefore.call(this, comment, refChild);\n        }\n        // iframewindow.parent\n        case \"IFRAME\": {\n          // js-iframejs-iframe\n          if (element.getAttribute(WUJIE_DATA_FLAG) === \"\") {\n            return rawAppendChild.call(rawDocumentQuerySelector.call(this.ownerDocument, \"html\"), element);\n          }\n          const res = rawDOMAppendOrInsertBefore.call(this, element, refChild);\n          execHooks(plugins, \"appendOrInsertElementHook\", element, iframe.contentWindow);\n          return res;\n        }\n        default:\n      }\n    }\n  };\n}\n\nfunction findScriptElementFromIframe(rawElement: HTMLScriptElement, wujieId: string) {\n  const wujieTag = getTagFromScript(rawElement);\n  const sandbox = getWujieById(wujieId);\n  const { iframe } = sandbox;\n  const targetScript = iframe.contentWindow.__WUJIE_RAW_DOCUMENT_HEAD__.querySelector(\n    `script[${WUJIE_SCRIPT_ID}='${wujieTag}']`\n  );\n  if (targetScript === null) {\n    warn(WUJIE_TIPS_NO_SCRIPT, `<script ${WUJIE_SCRIPT_ID}='${wujieTag}'/>`);\n  }\n  return { targetScript, iframe };\n}\n\nfunction rewriteContains(opts: { rawElementContains: (other: Node | null) => boolean; wujieId: string }) {\n  return function contains(other: Node | null) {\n    const element = other as HTMLElement;\n    const { rawElementContains, wujieId } = opts;\n    if (element && isScriptElement(element)) {\n      const { targetScript } = findScriptElementFromIframe(element as HTMLScriptElement, wujieId);\n      return targetScript !== null;\n    }\n    return rawElementContains(element);\n  };\n}\n\nfunction rewriteRemoveChild(opts: { rawElementRemoveChild: <T extends Node>(child: T) => T; wujieId: string }) {\n  return function removeChild(child: Node) {\n    const element = child as HTMLElement;\n    const { rawElementRemoveChild, wujieId } = opts;\n    if (element && isScriptElement(element)) {\n      const { targetScript, iframe } = findScriptElementFromIframe(element as HTMLScriptElement, wujieId);\n      if (targetScript !== null) {\n        return iframe.contentWindow.__WUJIE_RAW_DOCUMENT_HEAD__.removeChild(targetScript);\n      }\n      return null;\n    }\n    return rawElementRemoveChild(element);\n  };\n}\n\n/**\n * headbodyheadbody\n */\nfunction patchEventListener(element: HTMLHeadElement | HTMLBodyElement) {\n  const listenerMap = new Map<string, EventListenerOrEventListenerObject[]>();\n  element._cacheListeners = listenerMap;\n\n  element.addEventListener = (\n    type: string,\n    listener: EventListenerOrEventListenerObject,\n    options?: boolean | AddEventListenerOptions\n  ) => {\n    const listeners = listenerMap.get(type) || [];\n    listenerMap.set(type, [...listeners, listener]);\n    return rawAddEventListener.call(element, type, listener, options);\n  };\n\n  element.removeEventListener = (\n    type: string,\n    listener: EventListenerOrEventListenerObject,\n    options?: boolean | AddEventListenerOptions\n  ) => {\n    const typeListeners = listenerMap.get(type);\n    const index = typeListeners?.indexOf(listener);\n    if (typeListeners?.length && index !== -1) {\n      typeListeners.splice(index, 1);\n    }\n    return rawRemoveEventListener.call(element, type, listener, options);\n  };\n}\n\n/**\n * headbody\n */\nexport function removeEventListener(element: HTMLHeadElement | HTMLBodyElement) {\n  const listenerMap = element._cacheListeners;\n  [...listenerMap.entries()].forEach(([type, listeners]) => {\n    listeners.forEach((listener) => rawRemoveEventListener.call(element, type, listener));\n  });\n}\n\n/**\n * patch head and body in render\n * intercept appendChild and insertBefore\n */\nexport function patchRenderEffect(render: ShadowRoot | Document, id: string, degrade: boolean): void {\n  // domiframeiframe\n  if (!degrade) {\n    patchEventListener(render.head);\n    patchEventListener(render.body as HTMLBodyElement);\n  }\n\n  render.head.appendChild = rewriteAppendOrInsertChild({\n    rawDOMAppendOrInsertBefore: rawAppendChild,\n    wujieId: id,\n  }) as typeof rawAppendChild;\n  render.head.insertBefore = rewriteAppendOrInsertChild({\n    rawDOMAppendOrInsertBefore: rawHeadInsertBefore as any,\n    wujieId: id,\n  }) as typeof rawHeadInsertBefore;\n  render.head.removeChild = rewriteRemoveChild({\n    rawElementRemoveChild: rawElementRemoveChild.bind(render.head),\n    wujieId: id,\n  }) as typeof rawElementRemoveChild;\n  render.head.contains = rewriteContains({\n    rawElementContains: rawElementContains.bind(render.head),\n    wujieId: id,\n  }) as typeof rawElementContains;\n  render.contains = rewriteContains({\n    rawElementContains: rawElementContains.bind(render),\n    wujieId: id,\n  }) as typeof rawElementContains;\n  render.body.appendChild = rewriteAppendOrInsertChild({\n    rawDOMAppendOrInsertBefore: rawAppendChild,\n    wujieId: id,\n  }) as typeof rawAppendChild;\n  render.body.insertBefore = rewriteAppendOrInsertChild({\n    rawDOMAppendOrInsertBefore: rawBodyInsertBefore as any,\n    wujieId: id,\n  }) as typeof rawBodyInsertBefore;\n}\n","import {\n  WUJIE_APP_ID,\n  WUJIE_IFRAME_CLASS,\n  WUJIE_SHADE_STYLE,\n  CONTAINER_POSITION_DATA_FLAG,\n  CONTAINER_OVERFLOW_DATA_FLAG,\n  LOADING_DATA_FLAG,\n  WUJIE_LOADING_STYLE,\n  WUJIE_LOADING_SVG,\n} from \"./constant\";\nimport {\n  getWujieById,\n  rawAppendChild,\n  rawElementAppendChild,\n  rawElementRemoveChild,\n  relativeElementTagAttrMap,\n} from \"./common\";\nimport { getExternalStyleSheets } from \"./entry\";\nimport Wujie from \"./sandbox\";\nimport { patchElementEffect } from \"./iframe\";\nimport { patchRenderEffect } from \"./effect\";\nimport { getCssLoader, getPresetLoaders } from \"./plugin\";\nimport { getAbsolutePath, getContainer, getCurUrl, setAttrsToElement } from \"./utils\";\n\nconst cssSelectorMap = {\n  \":root\": \":host\",\n};\n\ndeclare global {\n  interface ShadowRoot {\n    head: HTMLHeadElement;\n    body: HTMLBodyElement;\n  }\n}\n\n/**\n *  wujie webComponentshadowdom\n */\nexport function defineWujieWebComponent() {\n  const customElements = window.customElements;\n  if (customElements && !customElements?.get(\"wujie-app\")) {\n    class WujieApp extends HTMLElement {\n      connectedCallback(): void {\n        if (this.shadowRoot) return;\n        const shadowRoot = this.attachShadow({ mode: \"open\" });\n        const sandbox = getWujieById(this.getAttribute(WUJIE_APP_ID));\n        patchElementEffect(shadowRoot, sandbox.iframe.contentWindow);\n        sandbox.shadowRoot = shadowRoot;\n      }\n\n      disconnectedCallback(): void {\n        const sandbox = getWujieById(this.getAttribute(WUJIE_APP_ID));\n        sandbox?.unmount();\n      }\n    }\n    customElements?.define(\"wujie-app\", WujieApp);\n  }\n}\n\nexport function createWujieWebComponent(id: string): HTMLElement {\n  const contentElement = window.document.createElement(\"wujie-app\");\n  contentElement.setAttribute(WUJIE_APP_ID, id);\n  contentElement.classList.add(WUJIE_IFRAME_CLASS);\n  return contentElement;\n}\n\n/**\n * \n */\nexport function renderElementToContainer(\n  element: Element | ChildNode,\n  selectorOrElement: string | HTMLElement\n): HTMLElement {\n  const container = getContainer(selectorOrElement);\n  if (container && !container.contains(element)) {\n    //  loading \n    if (!container.querySelector(`div[${LOADING_DATA_FLAG}]`)) {\n      // \n      clearChild(container);\n    }\n    // \n    if (element) {\n      rawElementAppendChild.call(container, element);\n    }\n  }\n  return container;\n}\n\n/**\n * iframe\n */\nexport function initRenderIframeAndContainer(\n  id: string,\n  parent: string | HTMLElement,\n  degradeAttrs: { [key: string]: any } = {}\n): { iframe: HTMLIFrameElement; container: HTMLElement } {\n  const iframe = createIframeContainer(id, degradeAttrs);\n  const container = renderElementToContainer(iframe, parent);\n  const contentDocument = iframe.contentWindow.document;\n  contentDocument.open();\n  contentDocument.write(\"<!DOCTYPE html><html><head></head><body></body></html>\");\n  contentDocument.close();\n  return { iframe, container };\n}\n\n/**\n * css-before-loader  css-after-loader\n */\nasync function processCssLoaderForTemplate(sandbox: Wujie, html: HTMLHtmlElement): Promise<HTMLHtmlElement> {\n  const document = sandbox.iframe.contentDocument;\n  const { plugins, replace, proxyLocation } = sandbox;\n  const cssLoader = getCssLoader({ plugins, replace });\n  const cssBeforeLoaders = getPresetLoaders(\"cssBeforeLoaders\", plugins);\n  const cssAfterLoaders = getPresetLoaders(\"cssAfterLoaders\", plugins);\n  const curUrl = getCurUrl(proxyLocation);\n\n  return await Promise.all([\n    Promise.all(\n      getExternalStyleSheets(cssBeforeLoaders, sandbox.fetch, sandbox.lifecycles.loadError).map(\n        ({ src, contentPromise }) => contentPromise.then((content) => ({ src, content }))\n      )\n    ).then((contentList) => {\n      contentList.forEach(({ src, content }) => {\n        if (!content) return;\n        const styleElement = document.createElement(\"style\");\n        styleElement.setAttribute(\"type\", \"text/css\");\n        styleElement.appendChild(document.createTextNode(content ? cssLoader(content, src, curUrl) : content));\n        const head = html.querySelector(\"head\");\n        const body = html.querySelector(\"body\");\n        html.insertBefore(styleElement, head || body || html.firstChild);\n      });\n    }),\n    Promise.all(\n      getExternalStyleSheets(cssAfterLoaders, sandbox.fetch, sandbox.lifecycles.loadError).map(\n        ({ src, contentPromise }) => contentPromise.then((content) => ({ src, content }))\n      )\n    ).then((contentList) => {\n      contentList.forEach(({ src, content }) => {\n        if (!content) return;\n        const styleElement = document.createElement(\"style\");\n        styleElement.setAttribute(\"type\", \"text/css\");\n        styleElement.appendChild(document.createTextNode(content ? cssLoader(content, src, curUrl) : content));\n        html.appendChild(styleElement);\n      });\n    }),\n  ]).then(\n    () => html,\n    () => html\n  );\n}\n\n// htmlheadbody\nfunction replaceHeadAndBody(html: HTMLHtmlElement, head: HTMLHeadElement, body: HTMLBodyElement): HTMLHtmlElement {\n  const headElement = html.querySelector(\"head\");\n  const bodyElement = html.querySelector(\"body\");\n  if (headElement) {\n    while (headElement.firstChild) {\n      rawAppendChild.call(head, headElement.firstChild.cloneNode(true));\n      headElement.removeChild(headElement.firstChild);\n    }\n    headElement.parentNode.replaceChild(head, headElement);\n  }\n  if (bodyElement) {\n    while (bodyElement.firstChild) {\n      rawAppendChild.call(body, bodyElement.firstChild.cloneNode(true));\n      bodyElement.removeChild(bodyElement.firstChild);\n    }\n    bodyElement.parentNode.replaceChild(body, bodyElement);\n  }\n  return html;\n}\n\n/**\n * templatehtml\n */\nfunction renderTemplateToHtml(iframeWindow: Window, template: string): HTMLHtmlElement {\n  const sandbox = iframeWindow.__WUJIE;\n  const { head, body, alive, execFlag } = sandbox;\n  const document = iframeWindow.document;\n  let html = document.createElement(\"html\");\n  html.innerHTML = template;\n  // headbody\n  if (!alive && execFlag) {\n    html = replaceHeadAndBody(html, head, body);\n  } else {\n    sandbox.head = html.querySelector(\"head\");\n    sandbox.body = html.querySelector(\"body\");\n  }\n  const ElementIterator = document.createTreeWalker(html, NodeFilter.SHOW_ELEMENT, null, false);\n  let nextElement = ElementIterator.currentNode as HTMLElement;\n  while (nextElement) {\n    patchElementEffect(nextElement, iframeWindow);\n    const relativeAttr = relativeElementTagAttrMap[nextElement.tagName];\n    const url = nextElement[relativeAttr];\n    if (relativeAttr) nextElement.setAttribute(relativeAttr, getAbsolutePath(url, nextElement.baseURI || \"\"));\n    nextElement = ElementIterator.nextNode() as HTMLElement;\n  }\n  if (!html.querySelector(\"head\")) {\n    const head = document.createElement(\"head\");\n    html.appendChild(head);\n  }\n  if (!html.querySelector(\"body\")) {\n    const body = document.createElement(\"body\");\n    html.appendChild(body);\n  }\n  return html;\n}\n\n/**\n * templateshadowRoot\n */\nexport async function renderTemplateToShadowRoot(\n  shadowRoot: ShadowRoot,\n  iframeWindow: Window,\n  template: string\n): Promise<void> {\n  const html = renderTemplateToHtml(iframeWindow, template);\n  //  css-before-loader  css-after-loader\n  const processedHtml = await processCssLoaderForTemplate(iframeWindow.__WUJIE, html);\n  // change ownerDocument\n  shadowRoot.appendChild(processedHtml);\n  const shade = document.createElement(\"div\");\n  shade.setAttribute(\"style\", WUJIE_SHADE_STYLE);\n  processedHtml.insertBefore(shade, processedHtml.firstChild);\n  shadowRoot.head = shadowRoot.querySelector(\"head\");\n  shadowRoot.body = shadowRoot.querySelector(\"body\");\n\n  //  html parentNode\n  Object.defineProperty(shadowRoot.firstChild, \"parentNode\", {\n    enumerable: true,\n    configurable: true,\n    get: () => iframeWindow.document,\n  });\n\n  patchRenderEffect(shadowRoot, iframeWindow.__WUJIE.id, false);\n}\n\nexport function createIframeContainer(id: string, degradeAttrs: { [key: string]: any } = {}): HTMLIFrameElement {\n  const iframe = document.createElement(\"iframe\");\n  const defaultStyle = \"height:100%;width:100%\";\n  setAttrsToElement(iframe, {\n    ...degradeAttrs,\n    style: [defaultStyle, degradeAttrs.style].join(\";\"),\n    [WUJIE_APP_ID]: id,\n  });\n  return iframe;\n}\n\n/**\n * templateiframe\n */\nexport async function renderTemplateToIframe(\n  renderDocument: Document,\n  iframeWindow: Window,\n  template: string\n): Promise<void> {\n  // template\n  const html = renderTemplateToHtml(iframeWindow, template);\n  //  css-before-loader  css-after-loader\n  const processedHtml = await processCssLoaderForTemplate(iframeWindow.__WUJIE, html);\n  renderDocument.replaceChild(processedHtml, renderDocument.documentElement);\n\n  //  html parentNode\n  Object.defineProperty(renderDocument.documentElement, \"parentNode\", {\n    enumerable: true,\n    configurable: true,\n    get: () => iframeWindow.document,\n  });\n\n  patchRenderEffect(renderDocument, iframeWindow.__WUJIE.id, true);\n}\n\n/**\n * Element\n */\nexport function clearChild(root: ShadowRoot | Node): void {\n  // \n  while (root?.firstChild) {\n    rawElementRemoveChild.call(root, root.firstChild);\n  }\n}\n\n/**\n * loading\n */\nexport function addLoading(el: string | HTMLElement, loading: HTMLElement): void {\n  const container = getContainer(el);\n  clearChild(container);\n  //  loading \n  let containerStyles = null;\n  try {\n    containerStyles = window.getComputedStyle(container);\n  } catch {\n    return;\n  }\n  if (containerStyles.position === \"static\") {\n    container.setAttribute(CONTAINER_POSITION_DATA_FLAG, containerStyles.position);\n    container.setAttribute(\n      CONTAINER_OVERFLOW_DATA_FLAG,\n      containerStyles.overflow === \"visible\" ? \"\" : containerStyles.overflow\n    );\n    container.style.setProperty(\"position\", \"relative\");\n    container.style.setProperty(\"overflow\", \"hidden\");\n  } else if ([\"relative\", \"sticky\"].includes(containerStyles.position)) {\n    container.setAttribute(\n      CONTAINER_OVERFLOW_DATA_FLAG,\n      containerStyles.overflow === \"visible\" ? \"\" : containerStyles.overflow\n    );\n    container.style.setProperty(\"overflow\", \"hidden\");\n  }\n  const loadingContainer = document.createElement(\"div\");\n  loadingContainer.setAttribute(LOADING_DATA_FLAG, \"\");\n  loadingContainer.setAttribute(\"style\", WUJIE_LOADING_STYLE);\n  if (loading) loadingContainer.appendChild(loading);\n  else loadingContainer.innerHTML = WUJIE_LOADING_SVG;\n  container.appendChild(loadingContainer);\n}\n/**\n * loading\n */\nexport function removeLoading(el: HTMLElement): void {\n  // \n  const positionFlag = el.getAttribute(CONTAINER_POSITION_DATA_FLAG);\n  const overflowFlag = el.getAttribute(CONTAINER_OVERFLOW_DATA_FLAG);\n  if (positionFlag) el.style.removeProperty(\"position\");\n  if (overflowFlag !== null) {\n    overflowFlag ? el.style.setProperty(\"overflow\", overflowFlag) : el.style.removeProperty(\"overflow\");\n  }\n  el.removeAttribute(CONTAINER_POSITION_DATA_FLAG);\n  el.removeAttribute(CONTAINER_OVERFLOW_DATA_FLAG);\n  const loadingContainer = el.querySelector(`div[${LOADING_DATA_FLAG}]`);\n  loadingContainer && el.removeChild(loadingContainer);\n}\n/**\n * \n * rootfont-face\n */\nexport function getPatchStyleElements(rootStyleSheets: Array<CSSStyleSheet>): Array<HTMLStyleElement | null> {\n  const rootCssRules = [];\n  const fontCssRules = [];\n  const rootStyleReg = /:root/g;\n\n  // rootcssRules\n  for (let i = 0; i < rootStyleSheets.length; i++) {\n    const cssRules = rootStyleSheets[i]?.cssRules ?? [];\n    for (let j = 0; j < cssRules.length; j++) {\n      const cssRuleText = cssRules[j].cssText;\n      // rootcssRule\n      if (rootStyleReg.test(cssRuleText)) {\n        rootCssRules.push(cssRuleText.replace(rootStyleReg, (match) => cssSelectorMap[match]));\n      }\n      // font-facecssRule\n      if (cssRules[j].type === CSSRule.FONT_FACE_RULE) {\n        fontCssRules.push(cssRuleText);\n      }\n    }\n  }\n\n  let rootStyleSheetElement = null;\n  let fontStyleSheetElement = null;\n\n  // host\n  if (rootCssRules.length) {\n    rootStyleSheetElement = window.document.createElement(\"style\");\n    rootStyleSheetElement.innerHTML = rootCssRules.join(\"\");\n  }\n\n  if (fontCssRules.length) {\n    fontStyleSheetElement = window.document.createElement(\"style\");\n    fontStyleSheetElement.innerHTML = fontCssRules.join(\"\");\n  }\n\n  return [rootStyleSheetElement, fontStyleSheetElement];\n}\n","import { anchorElementGenerator, getAnchorElementQueryMap, getSyncUrl, appRouteParse, getDegradeIframe } from \"./utils\";\nimport { renderIframeReplaceApp, patchEventTimeStamp } from \"./iframe\";\nimport { renderElementToContainer, initRenderIframeAndContainer } from \"./shadow\";\nimport { getWujieById, rawDocumentQuerySelector } from \"./common\";\n\n/**\n * \n */\nexport function syncUrlToWindow(iframeWindow: Window): void {\n  const { sync, id, prefix } = iframeWindow.__WUJIE;\n  let winUrlElement = anchorElementGenerator(window.location.href);\n  const queryMap = getAnchorElementQueryMap(winUrlElement);\n  // urlid\n  if (!sync && !queryMap[id]) return (winUrlElement = null);\n  const curUrl = iframeWindow.location.pathname + iframeWindow.location.search + iframeWindow.location.hash;\n  let validShortPath = \"\";\n  // \n  if (prefix) {\n    Object.keys(prefix).forEach((shortPath) => {\n      const longPath = prefix[shortPath];\n      // \n      if (curUrl.startsWith(longPath) && (!validShortPath || longPath.length > prefix[validShortPath].length)) {\n        validShortPath = shortPath;\n      }\n    });\n  }\n  // \n  if (sync) {\n    queryMap[id] = window.encodeURIComponent(\n      validShortPath ? curUrl.replace(prefix[validShortPath], `{${validShortPath}}`) : curUrl\n    );\n    // \n  } else {\n    delete queryMap[id];\n  }\n  const newQuery =\n    \"?\" +\n    Object.keys(queryMap)\n      .map((key) => key + \"=\" + queryMap[key])\n      .join(\"&\");\n  winUrlElement.search = newQuery;\n  if (winUrlElement.href !== window.location.href) {\n    window.history.replaceState(null, \"\", winUrlElement.href);\n  }\n  winUrlElement = null;\n}\n\n/**\n * \n */\nexport function syncUrlToIframe(iframeWindow: Window): void {\n  // \n  const { pathname, search, hash } = iframeWindow.location;\n  const { id, url, sync, execFlag, prefix, inject } = iframeWindow.__WUJIE;\n\n  // \n  const idUrl = sync && !execFlag ? getSyncUrl(id, prefix) : url;\n  // href\n  const syncUrl = (/^http/.test(idUrl) ? null : idUrl) || url;\n  const { appRoutePath } = appRouteParse(syncUrl);\n\n  const preAppRoutePath = pathname + search + hash;\n  if (preAppRoutePath !== appRoutePath) {\n    iframeWindow.history.replaceState(null, \"\", inject.mainHostPath + appRoutePath);\n  }\n}\n\n/**\n * \n * hash\n */\nexport function clearInactiveAppUrl(): void {\n  let winUrlElement = anchorElementGenerator(window.location.href);\n  const queryMap = getAnchorElementQueryMap(winUrlElement);\n  Object.keys(queryMap).forEach((id) => {\n    const sandbox = getWujieById(id);\n    if (!sandbox) return;\n    // \n    if (sandbox.execFlag && sandbox.sync && !sandbox.hrefFlag && !sandbox.activeFlag) {\n      delete queryMap[id];\n    }\n  });\n  const newQuery =\n    \"?\" +\n    Object.keys(queryMap)\n      .map((key) => key + \"=\" + queryMap[key])\n      .join(\"&\");\n  winUrlElement.search = newQuery;\n  if (winUrlElement.href !== window.location.href) {\n    window.history.replaceState(null, \"\", winUrlElement.href);\n  }\n  winUrlElement = null;\n}\n\n/**\n * url\n */\nexport function pushUrlToWindow(id: string, url: string): void {\n  let winUrlElement = anchorElementGenerator(window.location.href);\n  const queryMap = getAnchorElementQueryMap(winUrlElement);\n  queryMap[id] = window.encodeURIComponent(url);\n  const newQuery =\n    \"?\" +\n    Object.keys(queryMap)\n      .map((key) => key + \"=\" + queryMap[key])\n      .join(\"&\");\n  winUrlElement.search = newQuery;\n  window.history.pushState(null, \"\", winUrlElement.href);\n  winUrlElement = null;\n}\n\n/**\n * (window.location.href)\n */\nexport function processAppForHrefJump(): void {\n  window.addEventListener(\"popstate\", () => {\n    let winUrlElement = anchorElementGenerator(window.location.href);\n    const queryMap = getAnchorElementQueryMap(winUrlElement);\n    winUrlElement = null;\n    Object.keys(queryMap)\n      .map((id) => getWujieById(id))\n      .filter((sandbox) => sandbox)\n      .forEach((sandbox) => {\n        const url = queryMap[sandbox.id];\n        const iframeBody = rawDocumentQuerySelector.call(sandbox.iframe.contentDocument, \"body\");\n        // href\n        if (/http/.test(url)) {\n          if (sandbox.degrade) {\n            renderElementToContainer(sandbox.document.documentElement, iframeBody);\n            renderIframeReplaceApp(\n              window.decodeURIComponent(url),\n              getDegradeIframe(sandbox.id).parentElement,\n              sandbox.degradeAttrs\n            );\n          } else\n            renderIframeReplaceApp(\n              window.decodeURIComponent(url),\n              sandbox.shadowRoot.host.parentElement,\n              sandbox.degradeAttrs\n            );\n          sandbox.hrefFlag = true;\n          // href\n        } else if (sandbox.hrefFlag) {\n          if (sandbox.degrade) {\n            // \n            const { iframe } = initRenderIframeAndContainer(sandbox.id, sandbox.el, sandbox.degradeAttrs);\n            patchEventTimeStamp(iframe.contentWindow, sandbox.iframe.contentWindow);\n            iframe.contentWindow.onunload = () => {\n              sandbox.unmount();\n            };\n            iframe.contentDocument.appendChild(iframeBody.firstElementChild);\n            sandbox.document = iframe.contentDocument;\n          } else renderElementToContainer(sandbox.shadowRoot.host, sandbox.el);\n          sandbox.hrefFlag = false;\n        }\n      });\n  });\n}\n","import WuJie from \"./sandbox\";\nimport { ScriptObject } from \"./template\";\nimport { renderElementToContainer } from \"./shadow\";\nimport { syncUrlToWindow } from \"./sync\";\nimport {\n  fixElementCtrSrcOrHref,\n  isConstructable,\n  anchorElementGenerator,\n  isMatchSyncQueryById,\n  warn,\n  error,\n  execHooks,\n  getCurUrl,\n  getAbsolutePath,\n  setAttrsToElement,\n  setTagToScript,\n  getTagFromScript,\n} from \"./utils\";\nimport {\n  documentProxyProperties,\n  rawAddEventListener,\n  rawRemoveEventListener,\n  rawDocumentQuerySelector,\n  mainDocumentAddEventListenerEvents,\n  mainAndAppAddEventListenerEvents,\n  appDocumentAddEventListenerEvents,\n  appDocumentOnEvents,\n  appWindowAddEventListenerEvents,\n  appWindowOnEvent,\n  windowProxyProperties,\n  windowRegWhiteList,\n  rawWindowAddEventListener,\n  rawWindowRemoveEventListener,\n} from \"./common\";\nimport type { appAddEventListenerOptions } from \"./common\";\nimport { getJsLoader } from \"./plugin\";\nimport { WUJIE_TIPS_SCRIPT_ERROR_REQUESTED, WUJIE_DATA_FLAG } from \"./constant\";\nimport { ScriptObjectLoader } from \"./index\";\n\ndeclare global {\n  interface Window {\n    // \n    __POWERED_BY_WUJIE__?: boolean;\n    // \n    __WUJIE_PUBLIC_PATH__: string;\n    // querySelector\n    __WUJIE_RAW_DOCUMENT_QUERY_SELECTOR__: typeof Document.prototype.querySelector;\n\n    // iframecreateElement\n    __WUJIE_RAW_DOCUMENT_CREATE_ELEMENT__: typeof Document.prototype.createElement;\n\n    // iframecreateTextNode\n    __WUJIE_RAW_DOCUMENT_CREATE_TEXT_NODE__: typeof Document.prototype.createTextNode;\n\n    // iframehead\n    __WUJIE_RAW_DOCUMENT_HEAD__: typeof Document.prototype.head;\n\n    // querySelector\n    __WUJIE_RAW_DOCUMENT_QUERY_SELECTOR_ALL__: typeof Document.prototype.querySelectorAll;\n    // window\n    __WUJIE_RAW_WINDOW__: Window;\n    // \n    __WUJIE: WuJie;\n    // mount\n    __WUJIE_MOUNT: () => void;\n    // unmount\n    __WUJIE_UNMOUNT: () => void;\n    // document type\n    Document: typeof Document;\n    // img type\n    HTMLImageElement: typeof HTMLImageElement;\n    // node type\n    Node: typeof Node;\n    // element type\n    Element: typeof Element;\n    // htmlElement typeof\n    HTMLElement: typeof HTMLElement;\n    // anchor type\n    HTMLAnchorElement: typeof HTMLAnchorElement;\n    // source type\n    HTMLSourceElement: typeof HTMLSourceElement;\n    // link type\n    HTMLLinkElement: typeof HTMLLinkElement;\n    // script type\n    HTMLScriptElement: typeof HTMLScriptElement;\n    // media type\n    HTMLMediaElement: typeof HTMLMediaElement;\n    EventTarget: typeof EventTarget;\n    Event: typeof Event;\n    ShadowRoot: typeof ShadowRoot;\n    // \n    $wujie: { [key: string]: any };\n  }\n  interface HTMLHeadElement {\n    _cacheListeners: Map<string, EventListenerOrEventListenerObject[]>;\n  }\n  interface HTMLBodyElement {\n    _cacheListeners: Map<string, EventListenerOrEventListenerObject[]>;\n  }\n  interface Document {\n    createTreeWalker(\n      root: Node,\n      whatToShow?: number,\n      filter?: NodeFilter | null,\n      entityReferenceExpansion?: boolean\n    ): TreeWalker;\n  }\n}\n\n/**\n * windowiframe\n */\nfunction patchIframeEvents(iframeWindow: Window) {\n  iframeWindow.addEventListener = function addEventListener<K extends keyof WindowEventMap>(\n    type: K,\n    listener: (this: Window, ev: WindowEventMap[K]) => any,\n    options?: boolean | appAddEventListenerOptions\n  ) {\n    // \n    execHooks(iframeWindow.__WUJIE.plugins, \"windowAddEventListenerHook\", iframeWindow, type, listener, options);\n\n    if (appWindowAddEventListenerEvents.includes(type) || (typeof options === \"object\" && options.targetWindow)) {\n      const targetWindow = typeof options === \"object\" && options.targetWindow ? options?.targetWindow : iframeWindow;\n      return rawWindowAddEventListener.call(targetWindow, type, listener, options);\n    }\n    // window.windowwindow\n    rawWindowAddEventListener.call(window.__WUJIE_RAW_WINDOW__ || window, type, listener, options);\n  };\n\n  iframeWindow.removeEventListener = function removeEventListener<K extends keyof WindowEventMap>(\n    type: K,\n    listener: (this: Window, ev: WindowEventMap[K]) => any,\n    options?: boolean | appAddEventListenerOptions\n  ) {\n    // \n    execHooks(iframeWindow.__WUJIE.plugins, \"windowRemoveEventListenerHook\", iframeWindow, type, listener, options);\n\n    if (appWindowAddEventListenerEvents.includes(type) || (typeof options === \"object\" && options.targetWindow)) {\n      const targetWindow = typeof options === \"object\" && options.targetWindow ? options?.targetWindow : iframeWindow;\n      return rawWindowRemoveEventListener.call(targetWindow, type, listener, options);\n    }\n    rawWindowRemoveEventListener.call(window.__WUJIE_RAW_WINDOW__ || window, type, listener, options);\n  };\n}\n\nfunction patchIframeVariable(iframeWindow: Window, wujie: WuJie, appHostPath: string): void {\n  iframeWindow.__WUJIE = wujie;\n  iframeWindow.__WUJIE_PUBLIC_PATH__ = appHostPath + \"/\";\n  iframeWindow.$wujie = wujie.provide;\n  iframeWindow.__WUJIE_RAW_WINDOW__ = iframeWindow;\n}\n\n/**\n * iframehistorypushStatereplaceState\n * location\n * \n * @param iframeWindow\n * @param appHostPath  host path\n * @param mainHostPath  host path\n */\nfunction patchIframeHistory(iframeWindow: Window, appHostPath: string, mainHostPath: string): void {\n  const history = iframeWindow.history;\n  const rawHistoryPushState = history.pushState;\n  const rawHistoryReplaceState = history.replaceState;\n  history.pushState = function (data: any, title: string, url?: string): void {\n    const baseUrl =\n      mainHostPath + iframeWindow.location.pathname + iframeWindow.location.search + iframeWindow.location.hash;\n    const mainUrl = getAbsolutePath(url?.replace(appHostPath, \"\"), baseUrl);\n    const ignoreFlag = url === undefined;\n\n    rawHistoryPushState.call(history, data, title, ignoreFlag ? undefined : mainUrl);\n    if (ignoreFlag) return;\n    updateBase(iframeWindow, appHostPath, mainHostPath);\n    syncUrlToWindow(iframeWindow);\n  };\n  history.replaceState = function (data: any, title: string, url?: string): void {\n    const baseUrl =\n      mainHostPath + iframeWindow.location.pathname + iframeWindow.location.search + iframeWindow.location.hash;\n    const mainUrl = getAbsolutePath(url?.replace(appHostPath, \"\"), baseUrl);\n    const ignoreFlag = url === undefined;\n\n    rawHistoryReplaceState.call(history, data, title, ignoreFlag ? undefined : mainUrl);\n    if (ignoreFlag) return;\n    updateBase(iframeWindow, appHostPath, mainHostPath);\n    syncUrlToWindow(iframeWindow);\n  };\n}\n\n/**\n * iframebase\n * @param iframeWindow\n * @param url\n * @param appHostPath\n * @param mainHostPath\n */\nfunction updateBase(iframeWindow: Window, appHostPath: string, mainHostPath: string) {\n  const baseUrl = new URL(iframeWindow.location.href?.replace(mainHostPath, \"\"), appHostPath);\n  const baseElement = rawDocumentQuerySelector.call(iframeWindow.document, \"base\");\n  if (baseElement) baseElement.setAttribute(\"href\", appHostPath + baseUrl.pathname);\n}\n\n/**\n * patch iframe window effect\n * @param iframeWindow\n */\n// TODO \nfunction patchWindowEffect(iframeWindow: Window): void {\n  // \n  function processWindowProperty(key: string): boolean {\n    const value = iframeWindow[key];\n    try {\n      if (typeof value === \"function\" && !isConstructable(value)) {\n        iframeWindow[key] = window[key].bind(window);\n      } else {\n        iframeWindow[key] = window[key];\n      }\n      return true;\n    } catch (e) {\n      warn(e.message);\n      return false;\n    }\n  }\n  Object.getOwnPropertyNames(iframeWindow).forEach((key) => {\n    // \n    if (key === \"getSelection\") {\n      Object.defineProperty(iframeWindow, key, {\n        get: () => iframeWindow.document[key],\n      });\n      return;\n    }\n    // \n    if (windowProxyProperties.includes(key)) {\n      processWindowProperty(key);\n      return;\n    }\n    // \n    windowRegWhiteList.some((reg) => {\n      if (reg.test(key) && key in iframeWindow.parent) {\n        return processWindowProperty(key);\n      }\n      return false;\n    });\n  });\n  // onEvent set\n  const windowOnEvents = Object.getOwnPropertyNames(window)\n    .filter((p) => /^on/.test(p))\n    .filter((e) => !appWindowOnEvent.includes(e));\n\n  // window\n  windowOnEvents.forEach((e) => {\n    const descriptor = Object.getOwnPropertyDescriptor(iframeWindow, e) || {\n      enumerable: true,\n      writable: true,\n    };\n    try {\n      Object.defineProperty(iframeWindow, e, {\n        enumerable: descriptor.enumerable,\n        configurable: true,\n        get: () => window[e],\n        set:\n          descriptor.writable || descriptor.set\n            ? (handler) => {\n                window[e] = typeof handler === \"function\" ? handler.bind(iframeWindow) : handler;\n              }\n            : undefined,\n      });\n    } catch (e) {\n      warn(e.message);\n    }\n  });\n  // \n  execHooks(iframeWindow.__WUJIE.plugins, \"windowPropertyOverride\", iframeWindow);\n}\n\n/**\n * \n */\nfunction recordEventListeners(iframeWindow: Window) {\n  const sandbox = iframeWindow.__WUJIE;\n  iframeWindow.Node.prototype.addEventListener = function (\n    type: string,\n    handler: EventListenerOrEventListenerObject,\n    options?: boolean | AddEventListenerOptions\n  ): void {\n    // \n    const elementListenerList = sandbox.elementEventCacheMap.get(this);\n    if (elementListenerList) {\n      if (!elementListenerList.find((listener) => listener.handler === handler)) {\n        elementListenerList.push({ type, handler, options });\n      }\n    } else sandbox.elementEventCacheMap.set(this, [{ type, handler, options }]);\n    return rawAddEventListener.call(this, type, handler, options);\n  };\n\n  iframeWindow.Node.prototype.removeEventListener = function (\n    type: string,\n    handler: EventListenerOrEventListenerObject,\n    options?: boolean | EventListenerOptions\n  ): void {\n    // \n    const elementListenerList = sandbox.elementEventCacheMap.get(this);\n    if (elementListenerList) {\n      const index = elementListenerList?.findIndex((ele) => ele.handler === handler);\n      elementListenerList.splice(index, 1);\n    }\n    if (!elementListenerList?.length) {\n      sandbox.elementEventCacheMap.delete(this);\n    }\n    return rawRemoveEventListener.call(this, type, handler, options);\n  };\n}\n\n/**\n * \n */\nexport function recoverEventListeners(rootElement: Element | ChildNode, iframeWindow: Window) {\n  const sandbox = iframeWindow.__WUJIE;\n  const elementEventCacheMap: WeakMap<\n    Node,\n    Array<{ type: string; handler: EventListenerOrEventListenerObject; options: any }>\n  > = new WeakMap();\n  const ElementIterator = document.createTreeWalker(rootElement, NodeFilter.SHOW_ELEMENT, null, false);\n  let nextElement = ElementIterator.currentNode;\n  while (nextElement) {\n    const elementListenerList = sandbox.elementEventCacheMap.get(nextElement);\n    if (elementListenerList?.length) {\n      elementEventCacheMap.set(nextElement, elementListenerList);\n      elementListenerList.forEach((listener) => {\n        nextElement.addEventListener(listener.type, listener.handler, listener.options);\n      });\n    }\n    nextElement = ElementIterator.nextNode() as HTMLElement;\n  }\n  sandbox.elementEventCacheMap = elementEventCacheMap;\n}\n\n/**\n * \n */\nexport function recoverDocumentListeners(\n  oldRootElement: Element | ChildNode,\n  newRootElement: Element | ChildNode,\n  iframeWindow: Window\n) {\n  const sandbox = iframeWindow.__WUJIE;\n  const elementEventCacheMap: WeakMap<\n    Node,\n    Array<{ type: string; handler: EventListenerOrEventListenerObject; options: any }>\n  > = new WeakMap();\n  const elementListenerList = sandbox.elementEventCacheMap.get(oldRootElement);\n  if (elementListenerList?.length) {\n    elementEventCacheMap.set(newRootElement, elementListenerList);\n    elementListenerList.forEach((listener) => {\n      newRootElement.addEventListener(listener.type, listener.handler, listener.options);\n    });\n  }\n  sandbox.elementEventCacheMap = elementEventCacheMap;\n}\n\n/**\n * vuee.timeStamp < attachedTimestamp \n */\nexport function patchEventTimeStamp(targetWindow: Window, iframeWindow: Window) {\n  Object.defineProperty(targetWindow.Event.prototype, \"timeStamp\", {\n    get: () => {\n      return iframeWindow.document.createEvent(\"Event\").timeStamp;\n    },\n  });\n}\n\n/**\n * patch document effect\n * @param iframeWindow\n */\n// TODO \nfunction patchDocumentEffect(iframeWindow: Window): void {\n  const sandbox = iframeWindow.__WUJIE;\n\n  /**\n   *  addEventListenerremoveEventListener\n   *  handler thishandler.bind(document)\n   * removeEventListenerhandler => handler.bind(document)\n   * callback = handler.bind(document) removeEventListener\n   */\n  const handlerCallbackMap: WeakMap<EventListenerOrEventListenerObject, EventListenerOrEventListenerObject> =\n    new WeakMap();\n  const handlerTypeMap: WeakMap<EventListenerOrEventListenerObject, Array<string>> = new WeakMap();\n  iframeWindow.Document.prototype.addEventListener = function (\n    type: string,\n    handler: EventListenerOrEventListenerObject,\n    options?: boolean | AddEventListenerOptions\n  ): void {\n    let callback = handlerCallbackMap.get(handler);\n    const typeList = handlerTypeMap.get(handler);\n    //  handlerCallbackMap\n    if (!callback && handler) {\n      callback = typeof handler === \"function\" ? handler.bind(this) : handler;\n      handlerCallbackMap.set(handler, callback);\n    }\n    //  handlerTypeMap\n    if (typeList) {\n      if (!typeList.includes(type)) typeList.push(type);\n    } else {\n      handlerTypeMap.set(handler, [type]);\n    }\n\n    // \n    execHooks(iframeWindow.__WUJIE.plugins, \"documentAddEventListenerHook\", iframeWindow, type, callback, options);\n    if (appDocumentAddEventListenerEvents.includes(type)) {\n      return rawAddEventListener.call(this, type, callback, options);\n    }\n    //  sandbox.document\n    if (sandbox.degrade) return sandbox.document.addEventListener(type, callback, options);\n    if (mainDocumentAddEventListenerEvents.includes(type))\n      return window.document.addEventListener(type, callback, options);\n    if (mainAndAppAddEventListenerEvents.includes(type)) {\n      window.document.addEventListener(type, callback, options);\n      sandbox.shadowRoot.addEventListener(type, callback, options);\n      return;\n    }\n    sandbox.shadowRoot.addEventListener(type, callback, options);\n  };\n  iframeWindow.Document.prototype.removeEventListener = function (\n    type: string,\n    handler: EventListenerOrEventListenerObject,\n    options?: boolean | AddEventListenerOptions\n  ): void {\n    const callback: EventListenerOrEventListenerObject = handlerCallbackMap.get(handler);\n    const typeList = handlerTypeMap.get(handler);\n    if (callback) {\n      if (typeList?.includes(type)) {\n        typeList.splice(typeList.indexOf(type), 1);\n        if (!typeList.length) {\n          handlerCallbackMap.delete(handler);\n          handlerTypeMap.delete(handler);\n        }\n      }\n\n      // \n      execHooks(iframeWindow.__WUJIE.plugins, \"documentRemoveEventListenerHook\", iframeWindow, type, callback, options);\n      if (appDocumentAddEventListenerEvents.includes(type)) {\n        return rawRemoveEventListener.call(this, type, callback, options);\n      }\n      if (sandbox.degrade) return sandbox.document.removeEventListener(type, callback, options);\n      if (mainDocumentAddEventListenerEvents.includes(type)) {\n        return window.document.removeEventListener(type, callback, options);\n      }\n      if (mainAndAppAddEventListenerEvents.includes(type)) {\n        window.document.removeEventListener(type, callback, options);\n        sandbox.shadowRoot.removeEventListener(type, callback, options);\n        return;\n      }\n      sandbox.shadowRoot.removeEventListener(type, callback, options);\n    }\n  };\n  // onEvent\n  const elementOnEvents = Object.keys(iframeWindow.HTMLElement.prototype).filter((ele) => /^on/.test(ele));\n  const documentOnEvent = Object.keys(iframeWindow.Document.prototype)\n    .filter((ele) => /^on/.test(ele))\n    .filter((ele) => !appDocumentOnEvents.includes(ele));\n  elementOnEvents\n    .filter((e) => documentOnEvent.includes(e))\n    .forEach((e) => {\n      const descriptor = Object.getOwnPropertyDescriptor(iframeWindow.Document.prototype, e) || {\n        enumerable: true,\n        writable: true,\n      };\n      try {\n        Object.defineProperty(iframeWindow.Document.prototype, e, {\n          enumerable: descriptor.enumerable,\n          configurable: true,\n          get: () => (sandbox.degrade ? sandbox.document[e] : sandbox.shadowRoot.firstElementChild[e]),\n          set:\n            descriptor.writable || descriptor.set\n              ? (handler) => {\n                  const val = typeof handler === \"function\" ? handler.bind(iframeWindow.document) : handler;\n                  sandbox.degrade ? (sandbox.document[e] = val) : (sandbox.shadowRoot.firstElementChild[e] = val);\n                }\n              : undefined,\n        });\n      } catch (e) {\n        warn(e.message);\n      }\n    });\n  // get\n  const {\n    ownerProperties,\n    modifyProperties,\n    shadowProperties,\n    shadowMethods,\n    documentProperties,\n    documentMethods,\n    documentEvents,\n  } = documentProxyProperties;\n  modifyProperties.concat(shadowProperties, shadowMethods, documentProperties, documentMethods).forEach((propKey) => {\n    const descriptor = Object.getOwnPropertyDescriptor(iframeWindow.Document.prototype, propKey) || {\n      enumerable: true,\n      writable: true,\n    };\n    try {\n      Object.defineProperty(iframeWindow.Document.prototype, propKey, {\n        enumerable: descriptor.enumerable,\n        configurable: true,\n        get: () => sandbox.proxyDocument[propKey],\n        set: undefined,\n      });\n    } catch (e) {\n      warn(e.message);\n    }\n  });\n  // document\n  // TODO \n  documentEvents.forEach((propKey) => {\n    const descriptor = Object.getOwnPropertyDescriptor(iframeWindow.Document.prototype, propKey) || {\n      enumerable: true,\n      writable: true,\n    };\n    try {\n      Object.defineProperty(iframeWindow.Document.prototype, propKey, {\n        enumerable: descriptor.enumerable,\n        configurable: true,\n        get: () => (sandbox.degrade ? sandbox : window).document[propKey],\n        set:\n          descriptor.writable || descriptor.set\n            ? (handler) => {\n                (sandbox.degrade ? sandbox : window).document[propKey] =\n                  typeof handler === \"function\" ? handler.bind(iframeWindow.document) : handler;\n              }\n            : undefined,\n      });\n    } catch (e) {\n      warn(e.message);\n    }\n  });\n  // process owner property\n  ownerProperties.forEach((propKey) => {\n    Object.defineProperty(iframeWindow.document, propKey, {\n      enumerable: true,\n      configurable: true,\n      get: () => sandbox.proxyDocument[propKey],\n      set: undefined,\n    });\n  });\n  // \n  execHooks(iframeWindow.__WUJIE.plugins, \"documentPropertyOverride\", iframeWindow);\n}\n\n/**\n * patch Node effect\n * 1 getRootNode\n * 2 appendChildinsertBefore svg createElement  patch  patch\n * @param iframeWindow\n */\nfunction patchNodeEffect(iframeWindow: Window): void {\n  const rawGetRootNode = iframeWindow.Node.prototype.getRootNode;\n  const rawAppendChild = iframeWindow.Node.prototype.appendChild;\n  const rawInsertRule = iframeWindow.Node.prototype.insertBefore;\n  iframeWindow.Node.prototype.getRootNode = function (options?: GetRootNodeOptions): Node {\n    const rootNode = rawGetRootNode.call(this, options);\n    if (rootNode === iframeWindow.__WUJIE.shadowRoot) return iframeWindow.document;\n    else return rootNode;\n  };\n  iframeWindow.Node.prototype.appendChild = function <T extends Node>(node: T): T {\n    const res = rawAppendChild.call(this, node);\n    patchElementEffect(node, iframeWindow);\n    return res;\n  };\n  iframeWindow.Node.prototype.insertBefore = function <T extends Node>(node: T, child: Node | null): T {\n    const res = rawInsertRule.call(this, node, child);\n    patchElementEffect(node, iframeWindow);\n    return res;\n  };\n}\n\n/**\n * \n * @param iframeWindow\n */\nfunction patchRelativeUrlEffect(iframeWindow: Window): void {\n  fixElementCtrSrcOrHref(iframeWindow, iframeWindow.HTMLImageElement, \"src\");\n  fixElementCtrSrcOrHref(iframeWindow, iframeWindow.HTMLAnchorElement, \"href\");\n  fixElementCtrSrcOrHref(iframeWindow, iframeWindow.HTMLSourceElement, \"src\");\n  fixElementCtrSrcOrHref(iframeWindow, iframeWindow.HTMLLinkElement, \"href\");\n  fixElementCtrSrcOrHref(iframeWindow, iframeWindow.HTMLScriptElement, \"src\");\n  fixElementCtrSrcOrHref(iframeWindow, iframeWindow.HTMLMediaElement, \"src\");\n}\n\n/**\n * base\n */\nexport function initBase(iframeWindow: Window, url: string): void {\n  const iframeDocument = iframeWindow.document;\n  const baseElement = iframeDocument.createElement(\"base\");\n  const iframeUrlElement = anchorElementGenerator(iframeWindow.location.href);\n  const appUrlElement = anchorElementGenerator(url);\n  baseElement.setAttribute(\"href\", appUrlElement.protocol + \"//\" + appUrlElement.host + iframeUrlElement.pathname);\n  iframeDocument.head.appendChild(baseElement);\n}\n\n/**\n * iframedom\n * @param iframeWindow\n */\nfunction initIframeDom(iframeWindow: Window, wujie: WuJie, mainHostPath: string, appHostPath: string): void {\n  const iframeDocument = iframeWindow.document;\n  const newDoc = window.document.implementation.createHTMLDocument(\"\");\n  const newDocumentElement = iframeDocument.importNode(newDoc.documentElement, true);\n  iframeDocument.documentElement\n    ? iframeDocument.replaceChild(newDocumentElement, iframeDocument.documentElement)\n    : iframeDocument.appendChild(newDocumentElement);\n  iframeWindow.__WUJIE_RAW_DOCUMENT_HEAD__ = iframeDocument.head;\n  iframeWindow.__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR__ = iframeWindow.Document.prototype.querySelector;\n  iframeWindow.__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR_ALL__ = iframeWindow.Document.prototype.querySelectorAll;\n  iframeWindow.__WUJIE_RAW_DOCUMENT_CREATE_ELEMENT__ = iframeWindow.Document.prototype.createElement;\n  iframeWindow.__WUJIE_RAW_DOCUMENT_CREATE_TEXT_NODE__ = iframeWindow.Document.prototype.createTextNode;\n  initBase(iframeWindow, wujie.url);\n  patchIframeHistory(iframeWindow, appHostPath, mainHostPath);\n  patchIframeEvents(iframeWindow);\n  if (wujie.degrade) recordEventListeners(iframeWindow);\n  syncIframeUrlToWindow(iframeWindow);\n\n  patchWindowEffect(iframeWindow);\n  patchDocumentEffect(iframeWindow);\n  patchNodeEffect(iframeWindow);\n  patchRelativeUrlEffect(iframeWindow);\n}\n\n/**\n * js\n */\n// TODO \nfunction stopIframeLoading(iframeWindow: Window) {\n  const oldDoc = iframeWindow.document;\n  return new Promise<void>((resolve) => {\n    function loop() {\n      setTimeout(() => {\n        let newDoc = null;\n        try {\n          newDoc = iframeWindow.document;\n        } catch (err) {\n          newDoc = null;\n        }\n        // wait for document ready\n        if (!newDoc || newDoc == oldDoc) {\n          loop();\n        } else {\n          iframeWindow.stop ? iframeWindow.stop() : iframeWindow.document.execCommand(\"Stop\");\n          resolve();\n        }\n      }, 1);\n    }\n    loop();\n  });\n}\n\nexport function patchElementEffect(\n  element: (HTMLElement | Node | ShadowRoot) & { _hasPatch?: boolean },\n  iframeWindow: Window\n): void {\n  const proxyLocation = iframeWindow.__WUJIE.proxyLocation as Location;\n  if (element._hasPatch) return;\n  Object.defineProperties(element, {\n    baseURI: {\n      configurable: true,\n      get: () => proxyLocation.protocol + \"//\" + proxyLocation.host + proxyLocation.pathname,\n      set: undefined,\n    },\n    ownerDocument: {\n      configurable: true,\n      get: () => iframeWindow.document,\n    },\n    _hasPatch: { get: () => true },\n  });\n  execHooks(iframeWindow.__WUJIE.plugins, \"patchElementHook\", element, iframeWindow);\n}\n\n/**\n * \n * @param iframeWindow\n */\nexport function syncIframeUrlToWindow(iframeWindow: Window): void {\n  iframeWindow.addEventListener(\"hashchange\", () => syncUrlToWindow(iframeWindow));\n  iframeWindow.addEventListener(\"popstate\", () => {\n    syncUrlToWindow(iframeWindow);\n  });\n}\n\n/**\n * iframe\n * @param scriptResult script\n * @param iframeWindow\n * @param rawElement \n */\nexport function insertScriptToIframe(\n  scriptResult: ScriptObject | ScriptObjectLoader,\n  iframeWindow: Window,\n  rawElement?: HTMLScriptElement\n) {\n  const { src, module, content, crossorigin, crossoriginType, async, attrs, callback, onload } =\n    scriptResult as ScriptObjectLoader;\n  const scriptElement = iframeWindow.document.createElement(\"script\");\n  const nextScriptElement = iframeWindow.document.createElement(\"script\");\n  const { replace, plugins, proxyLocation } = iframeWindow.__WUJIE;\n  const jsLoader = getJsLoader({ plugins, replace });\n  let code = jsLoader(content, src, getCurUrl(proxyLocation));\n  // \n  attrs &&\n    Object.keys(attrs)\n      .filter((key) => !Object.keys(scriptResult).includes(key))\n      .forEach((key) => scriptElement.setAttribute(key, String(attrs[key])));\n\n  // \n  if (content) {\n    // patch location\n    if (!iframeWindow.__WUJIE.degrade && !module) {\n      code = `(function(window, self, global, location) {\n      ${code}\n}).bind(window.__WUJIE.proxy)(\n  window.__WUJIE.proxy,\n  window.__WUJIE.proxy,\n  window.__WUJIE.proxy,\n  window.__WUJIE.proxyLocation,\n);`;\n    }\n    //  webpack publicPath  auto \n    Object.defineProperty(scriptElement, \"src\", { get: () => src || \"\" });\n  } else {\n    src && scriptElement.setAttribute(\"src\", src);\n    crossorigin && scriptElement.setAttribute(\"crossorigin\", crossoriginType);\n  }\n  module && scriptElement.setAttribute(\"type\", \"module\");\n  scriptElement.textContent = code || \"\";\n  nextScriptElement.textContent =\n    \"if(window.__WUJIE.execQueue && window.__WUJIE.execQueue.length){ window.__WUJIE.execQueue.shift()()}\";\n\n  const container = rawDocumentQuerySelector.call(iframeWindow.document, \"head\");\n  const execNextScript = () => !async && container.appendChild(nextScriptElement);\n  const afterExecScript = () => {\n    onload?.();\n    execNextScript();\n  };\n\n  // \n  if (/^<!DOCTYPE html/i.test(code)) {\n    error(WUJIE_TIPS_SCRIPT_ERROR_REQUESTED, scriptResult);\n    return execNextScript();\n  }\n\n  // \n  if (rawElement) {\n    setTagToScript(scriptElement, getTagFromScript(rawElement));\n  }\n  // \n  const isOutlineScript = !content && src;\n  if (isOutlineScript) {\n    scriptElement.onload = afterExecScript;\n    scriptElement.onerror = afterExecScript;\n  }\n  container.appendChild(scriptElement);\n\n  // \n  callback?.(iframeWindow);\n  //  hooks\n  execHooks(plugins, \"appendOrInsertElementHook\", scriptElement, iframeWindow, rawElement);\n  // \n  !isOutlineScript && afterExecScript();\n}\n\n/**\n * iframe\n * @param src \n * @param shadowRoot\n */\nexport function renderIframeReplaceApp(\n  src: string,\n  element: HTMLElement,\n  degradeAttrs: { [key: string]: any } = {}\n): void {\n  const iframe = window.document.createElement(\"iframe\");\n  const defaultStyle = \"height:100%;width:100%\";\n  setAttrsToElement(iframe, { ...degradeAttrs, src, style: [defaultStyle, degradeAttrs.style].join(\";\") });\n  renderElementToContainer(iframe, element);\n}\n\n/**\n * js\n * iframe\n * iframehtml\n */\nexport function iframeGenerator(\n  sandbox: WuJie,\n  attrs: { [key: string]: any },\n  mainHostPath: string,\n  appHostPath: string,\n  appRoutePath: string\n): HTMLIFrameElement {\n  const iframe = window.document.createElement(\"iframe\");\n  const attrsMerge = { src: mainHostPath, style: \"display: none\", ...attrs, name: sandbox.id, [WUJIE_DATA_FLAG]: \"\" };\n  setAttrsToElement(iframe, attrsMerge);\n  window.document.body.appendChild(iframe);\n\n  const iframeWindow = iframe.contentWindow;\n  // \n  patchIframeVariable(iframeWindow, sandbox, appHostPath);\n  sandbox.iframeReady = stopIframeLoading(iframeWindow).then(() => {\n    if (!iframeWindow.__WUJIE) {\n      patchIframeVariable(iframeWindow, sandbox, appHostPath);\n    }\n    initIframeDom(iframeWindow, sandbox, mainHostPath, appHostPath);\n    /**\n     * url\n     */\n    if (!isMatchSyncQueryById(iframeWindow.__WUJIE.id)) {\n      iframeWindow.history.replaceState(null, \"\", mainHostPath + appRoutePath);\n    }\n  });\n  return iframe;\n}\n","import { patchElementEffect, renderIframeReplaceApp } from \"./iframe\";\nimport { renderElementToContainer } from \"./shadow\";\nimport { pushUrlToWindow } from \"./sync\";\nimport { documentProxyProperties, rawDocumentQuerySelector } from \"./common\";\nimport { WUJIE_TIPS_RELOAD_DISABLED } from \"./constant\";\nimport {\n  getTargetValue,\n  anchorElementGenerator,\n  getDegradeIframe,\n  isCallable,\n  checkProxyFunction,\n  warn,\n  stopMainAppRun,\n} from \"./utils\";\n\n/**\n * location href set\n */\nfunction locationHrefSet(iframe: HTMLIFrameElement, value: string, appHostPath: string): boolean {\n  const { shadowRoot, id, degrade, document, degradeAttrs } = iframe.contentWindow.__WUJIE;\n  let url = value;\n  if (!/^http/.test(url)) {\n    let hrefElement = anchorElementGenerator(url);\n    url = appHostPath + hrefElement.pathname + hrefElement.search + hrefElement.hash;\n    hrefElement = null;\n  }\n  iframe.contentWindow.__WUJIE.hrefFlag = true;\n  if (degrade) {\n    const iframeBody = rawDocumentQuerySelector.call(iframe.contentDocument, \"body\");\n    renderElementToContainer(document.documentElement, iframeBody);\n    renderIframeReplaceApp(window.decodeURIComponent(url), getDegradeIframe(id).parentElement, degradeAttrs);\n  } else renderIframeReplaceApp(url, shadowRoot.host.parentElement, degradeAttrs);\n  pushUrlToWindow(id, url);\n  return true;\n}\n\n/**\n * windowdocumentlocation\n */\nexport function proxyGenerator(\n  iframe: HTMLIFrameElement,\n  urlElement: HTMLAnchorElement,\n  mainHostPath: string,\n  appHostPath: string\n): {\n  proxyWindow: Window;\n  proxyDocument: Object;\n  proxyLocation: Object;\n} {\n  const proxyWindow = new Proxy(iframe.contentWindow, {\n    get: (target: Window, p: PropertyKey): any => {\n      // location\n      if (p === \"location\") {\n        return target.__WUJIE.proxyLocation;\n      }\n      // \n      if (p === \"self\" || (p === \"window\" && Object.getOwnPropertyDescriptor(window, \"window\").get)) {\n        return target.__WUJIE.proxy;\n      }\n      // this\n      if (p === \"__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR__\" || p === \"__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR_ALL__\") {\n        return target[p];\n      }\n      // this\n      return getTargetValue(target, p);\n    },\n\n    set: (target: Window, p: PropertyKey, value: any) => {\n      checkProxyFunction(value);\n      target[p] = value;\n      return true;\n    },\n\n    has: (target: Window, p: PropertyKey) => p in target,\n  });\n\n  // proxy document\n  const proxyDocument = new Proxy(\n    {},\n    {\n      get: function (_fakeDocument, propKey) {\n        const document = window.document;\n        const { shadowRoot, proxyLocation } = iframe.contentWindow.__WUJIE;\n        // iframewebcomponent\n        if (!shadowRoot) stopMainAppRun();\n        const rawCreateElement = iframe.contentWindow.__WUJIE_RAW_DOCUMENT_CREATE_ELEMENT__;\n        const rawCreateTextNode = iframe.contentWindow.__WUJIE_RAW_DOCUMENT_CREATE_TEXT_NODE__;\n        // need fix\n        if (propKey === \"createElement\" || propKey === \"createTextNode\") {\n          return new Proxy(document[propKey], {\n            apply(_createElement, _ctx, args) {\n              const rawCreateMethod = propKey === \"createElement\" ? rawCreateElement : rawCreateTextNode;\n              const element = rawCreateMethod.apply(iframe.contentDocument, args);\n              patchElementEffect(element, iframe.contentWindow);\n              return element;\n            },\n          });\n        }\n        if (propKey === \"documentURI\" || propKey === \"URL\") {\n          return (proxyLocation as Location).href;\n        }\n\n        // from shadowRoot\n        if (\n          propKey === \"getElementsByTagName\" ||\n          propKey === \"getElementsByClassName\" ||\n          propKey === \"getElementsByName\"\n        ) {\n          return new Proxy(shadowRoot.querySelectorAll, {\n            apply(querySelectorAll, _ctx, args) {\n              let arg = args[0];\n              if (_ctx !== iframe.contentDocument) {\n                return _ctx[propKey].apply(_ctx, args);\n              }\n\n              if (propKey === \"getElementsByTagName\" && arg === \"script\") {\n                return iframe.contentDocument.scripts;\n              }\n              if (propKey === \"getElementsByClassName\") arg = \".\" + arg;\n              if (propKey === \"getElementsByName\") arg = `[name=\"${arg}\"]`;\n\n              // FIXME: This string must be a valid CSS selector string; if it's not, a SyntaxError exception is thrown;\n              // so we should ensure that the program can execute normally in case of exceptions.\n              // reference: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll\n\n              let res: NodeList[] | [];\n              try {\n                res = querySelectorAll.call(shadowRoot, arg);\n              } catch (error) {\n                res = [];\n              }\n\n              return res;\n            },\n          });\n        }\n        if (propKey === \"getElementById\") {\n          return new Proxy(shadowRoot.querySelector, {\n            // case document.querySelector.call\n            apply(target, ctx, args) {\n              if (ctx !== iframe.contentDocument) {\n                return ctx[propKey]?.apply(ctx, args);\n              }\n              return (\n                target.call(shadowRoot, `[id=\"${args[0]}\"]`) ||\n                iframe.contentWindow.__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR__.call(\n                  iframe.contentWindow.document,\n                  `#${args[0]}`\n                )\n              );\n            },\n          });\n        }\n        if (propKey === \"querySelector\" || propKey === \"querySelectorAll\") {\n          const rawPropMap = {\n            querySelector: \"__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR__\",\n            querySelectorAll: \"__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR_ALL__\",\n          };\n          return new Proxy(shadowRoot[propKey], {\n            apply(target, ctx, args) {\n              if (ctx !== iframe.contentDocument) {\n                return ctx[propKey]?.apply(ctx, args);\n              }\n              // shadowDomarraybaserouter\n              return (\n                target.apply(shadowRoot, args) ||\n                (args[0] === \"base\"\n                  ? null\n                  : iframe.contentWindow[rawPropMap[propKey]].call(iframe.contentWindow.document, args[0]))\n              );\n            },\n          });\n        }\n        if (propKey === \"documentElement\" || propKey === \"scrollingElement\") return shadowRoot.firstElementChild;\n        if (propKey === \"forms\") return shadowRoot.querySelectorAll(\"form\");\n        if (propKey === \"images\") return shadowRoot.querySelectorAll(\"img\");\n        if (propKey === \"links\") return shadowRoot.querySelectorAll(\"a\");\n        const { ownerProperties, shadowProperties, shadowMethods, documentProperties, documentMethods } =\n          documentProxyProperties;\n        if (ownerProperties.concat(shadowProperties).includes(propKey.toString())) {\n          if (propKey === \"activeElement\" && shadowRoot.activeElement === null) return shadowRoot.body;\n          return shadowRoot[propKey];\n        }\n        if (shadowMethods.includes(propKey.toString())) {\n          return getTargetValue(shadowRoot, propKey) ?? getTargetValue(document, propKey);\n        }\n        // from window.document\n        if (documentProperties.includes(propKey.toString())) {\n          return document[propKey];\n        }\n        if (documentMethods.includes(propKey.toString())) {\n          return getTargetValue(document, propKey);\n        }\n      },\n    }\n  );\n\n  // proxy location\n  const proxyLocation = new Proxy(\n    {},\n    {\n      get: function (_fakeLocation, propKey) {\n        const location = iframe.contentWindow.location;\n        if (\n          propKey === \"host\" ||\n          propKey === \"hostname\" ||\n          propKey === \"protocol\" ||\n          propKey === \"port\" ||\n          propKey === \"origin\"\n        ) {\n          return urlElement[propKey];\n        }\n        if (propKey === \"href\") {\n          return location[propKey].replace(mainHostPath, appHostPath);\n        }\n        if (propKey === \"reload\") {\n          warn(WUJIE_TIPS_RELOAD_DISABLED);\n          return () => null;\n        }\n        if (propKey === \"replace\") {\n          return new Proxy(location[propKey], {\n            apply(replace, _ctx, args) {\n              return replace.call(location, args[0]?.replace(appHostPath, mainHostPath));\n            },\n          });\n        }\n        return getTargetValue(location, propKey);\n      },\n      set: function (_fakeLocation, propKey, value) {\n        // iframe\n        if (propKey === \"href\") {\n          return locationHrefSet(iframe, value, appHostPath);\n        }\n        iframe.contentWindow.location[propKey] = value;\n        return true;\n      },\n      ownKeys: function () {\n        return Object.keys(iframe.contentWindow.location).filter((key) => key !== \"reload\");\n      },\n      getOwnPropertyDescriptor: function (_target, key) {\n        return { enumerable: true, configurable: true, value: this[key] };\n      },\n    }\n  );\n  return { proxyWindow, proxyDocument, proxyLocation };\n}\n\n/**\n * documentlocation\n */\nexport function localGenerator(\n  iframe: HTMLIFrameElement,\n  urlElement: HTMLAnchorElement,\n  mainHostPath: string,\n  appHostPath: string\n): {\n  proxyDocument: Object;\n  proxyLocation: Object;\n} {\n  //  document\n  const proxyDocument = {};\n  const sandbox = iframe.contentWindow.__WUJIE;\n  // \n  Object.defineProperties(proxyDocument, {\n    createElement: {\n      get: () => {\n        return function (...args) {\n          const element = iframe.contentWindow.__WUJIE_RAW_DOCUMENT_CREATE_ELEMENT__.apply(\n            iframe.contentDocument,\n            args\n          );\n          patchElementEffect(element, iframe.contentWindow);\n          return element;\n        };\n      },\n    },\n    createTextNode: {\n      get: () => {\n        return function (...args) {\n          const element = iframe.contentWindow.__WUJIE_RAW_DOCUMENT_CREATE_TEXT_NODE__.apply(\n            iframe.contentDocument,\n            args\n          );\n          patchElementEffect(element, iframe.contentWindow);\n          return element;\n        };\n      },\n    },\n    documentURI: {\n      get: () => (sandbox.proxyLocation as Location).href,\n    },\n    URL: {\n      get: () => (sandbox.proxyLocation as Location).href,\n    },\n    getElementsByTagName: {\n      get() {\n        return function (...args) {\n          const tagName = args[0];\n          if (tagName === \"script\") {\n            return iframe.contentDocument.scripts as any;\n          }\n          return sandbox.document.getElementsByTagName(tagName) as any;\n        };\n      },\n    },\n  });\n  // \n  const {\n    modifyLocalProperties,\n    modifyProperties,\n    ownerProperties,\n    shadowProperties,\n    shadowMethods,\n    documentProperties,\n    documentMethods,\n  } = documentProxyProperties;\n  modifyProperties\n    .filter((key) => !modifyLocalProperties.includes(key))\n    .concat(ownerProperties, shadowProperties, shadowMethods, documentProperties, documentMethods)\n    .forEach((key) => {\n      Object.defineProperty(proxyDocument, key, {\n        get: () => {\n          const value = sandbox.document?.[key];\n          return isCallable(value) ? value.bind(sandbox.document) : value;\n        },\n      });\n    });\n\n  //  location\n  const proxyLocation = {};\n  const location = iframe.contentWindow.location;\n  const locationKeys = Object.keys(location);\n  const constantKey = [\"host\", \"hostname\", \"port\", \"protocol\", \"port\"];\n  constantKey.forEach((key) => {\n    proxyLocation[key] = urlElement[key];\n  });\n  Object.defineProperties(proxyLocation, {\n    href: {\n      get: () => location.href.replace(mainHostPath, appHostPath),\n      set: (value) => {\n        locationHrefSet(iframe, value, appHostPath);\n      },\n    },\n    reload: {\n      get() {\n        warn(WUJIE_TIPS_RELOAD_DISABLED);\n        return () => null;\n      },\n    },\n  });\n  locationKeys\n    .filter((key) => !constantKey.concat([\"href\", \"reload\"]).includes(key))\n    .forEach((key) => {\n      Object.defineProperty(proxyLocation, key, {\n        get: () => (isCallable(location[key]) ? location[key].bind(location) : location[key]),\n      });\n    });\n  return { proxyDocument, proxyLocation };\n}\n","import { warn, error } from \"./utils\";\nimport { WUJIE_ALL_EVENT, WUJIE_TIPS_NO_SUBJECT } from \"./constant\";\n\nexport type EventObj = { [event: string]: Array<Function> };\n\n// map\nexport const appEventObjMap = window.__POWERED_BY_WUJIE__\n  ? window.__WUJIE.inject.appEventObjMap\n  : new Map<String, EventObj>();\n\n// eventBus \nexport class EventBus {\n  private id: string;\n  private eventObj: EventObj;\n\n  constructor(id: string) {\n    this.id = id;\n    this.$clear();\n    if (!appEventObjMap.get(this.id)) {\n      appEventObjMap.set(this.id, {});\n    }\n    this.eventObj = appEventObjMap.get(this.id);\n  }\n\n  // \n  public $on(event: string, fn: Function): EventBus {\n    const cbs = this.eventObj[event];\n    if (!cbs) {\n      this.eventObj[event] = [fn];\n      return this;\n    }\n    if (!cbs.includes(fn)) cbs.push(fn);\n    return this;\n  }\n\n  /** $emit$emit */\n  public $onAll(fn: (event: string, ...args: Array<any>) => any): EventBus {\n    return this.$on(WUJIE_ALL_EVENT, fn);\n  }\n\n  // \n  public $once(event: string, fn: Function): void {\n    const on = function (...args: Array<any>) {\n      this.$off(event, on);\n      fn(...args);\n    }.bind(this);\n    this.$on(event, on);\n  }\n\n  // \n  public $off(event: string, fn: Function): EventBus {\n    const cbs = this.eventObj[event];\n    if (!event || !cbs || !cbs.length) {\n      warn(`${event} ${WUJIE_TIPS_NO_SUBJECT}`);\n      return this;\n    }\n\n    let cb;\n    let i = cbs.length;\n    while (i--) {\n      cb = cbs[i];\n      if (cb === fn) {\n        cbs.splice(i, 1);\n        break;\n      }\n    }\n    return this;\n  }\n\n  // $onAll\n  public $offAll(fn: Function): EventBus {\n    return this.$off(WUJIE_ALL_EVENT, fn);\n  }\n\n  // \n  public $emit(event: string, ...args: Array<any>): EventBus {\n    let cbs = [];\n    let allCbs = [];\n\n    appEventObjMap.forEach((eventObj) => {\n      if (eventObj[event]) cbs = cbs.concat(eventObj[event]);\n      if (eventObj[WUJIE_ALL_EVENT]) allCbs = allCbs.concat(eventObj[WUJIE_ALL_EVENT]);\n    });\n\n    if (!event || (cbs.length === 0 && allCbs.length === 0)) {\n      warn(`${event} ${WUJIE_TIPS_NO_SUBJECT}`);\n    } else {\n      try {\n        for (let i = 0, l = cbs.length; i < l; i++) cbs[i](...args);\n        for (let i = 0, l = allCbs.length; i < l; i++) allCbs[i](event, ...args);\n      } catch (e) {\n        error(e);\n      }\n    }\n    return this;\n  }\n\n  // \n  public $clear(): EventBus {\n    const eventObj = appEventObjMap.get(this.id) ?? {};\n    const events = Object.keys(eventObj);\n    events.forEach((event) => delete eventObj[event]);\n    return this;\n  }\n}\n","import {\n  iframeGenerator,\n  recoverEventListeners,\n  recoverDocumentListeners,\n  insertScriptToIframe,\n  patchEventTimeStamp,\n} from \"./iframe\";\nimport { syncUrlToWindow, syncUrlToIframe, clearInactiveAppUrl } from \"./sync\";\nimport {\n  createWujieWebComponent,\n  clearChild,\n  getPatchStyleElements,\n  renderElementToContainer,\n  renderTemplateToShadowRoot,\n  renderTemplateToIframe,\n  initRenderIframeAndContainer,\n  removeLoading,\n} from \"./shadow\";\nimport { proxyGenerator, localGenerator } from \"./proxy\";\nimport { ScriptResultList } from \"./entry\";\nimport { getPlugins, getPresetLoaders } from \"./plugin\";\nimport { removeEventListener } from \"./effect\";\nimport {\n  SandboxCache,\n  idToSandboxCacheMap,\n  addSandboxCacheWithWujie,\n  deleteWujieById,\n  rawElementAppendChild,\n  rawDocumentQuerySelector,\n} from \"./common\";\nimport { EventBus, appEventObjMap, EventObj } from \"./event\";\nimport { isFunction, wujieSupport, appRouteParse, requestIdleCallback, getAbsolutePath, eventTrigger } from \"./utils\";\nimport { WUJIE_DATA_ATTACH_CSS_FLAG } from \"./constant\";\nimport { plugin, ScriptObjectLoader, loadErrorHandler } from \"./index\";\n\nexport type lifecycle = (appWindow: Window) => any;\ntype lifecycles = {\n  beforeLoad: lifecycle;\n  beforeMount: lifecycle;\n  afterMount: lifecycle;\n  beforeUnmount: lifecycle;\n  afterUnmount: lifecycle;\n  activated: lifecycle;\n  deactivated: lifecycle;\n  loadError: loadErrorHandler;\n};\n/**\n *  Proxyiframe \n */\nexport default class Wujie {\n  public id: string;\n  /**  */\n  public url: string;\n  /**  */\n  public alive: boolean;\n  /** window */\n  public proxy: WindowProxy;\n  /** document */\n  public proxyDocument: Object;\n  /** location */\n  public proxyLocation: Object;\n  /**  */\n  public bus: EventBus;\n  /**  */\n  public el: HTMLElement;\n  /** js */\n  public iframe: HTMLIFrameElement;\n  /** css */\n  public shadowRoot: ShadowRoot;\n  /** template */\n  public template: string;\n  /**  */\n  public replace: (code: string) => string;\n  /** fetch */\n  public fetch: (input: RequestInfo, init?: RequestInit) => Promise<Response>;\n  /**  */\n  public lifecycles: lifecycles;\n  /**  */\n  public plugins: Array<plugin>;\n  /** jsready */\n  public iframeReady: Promise<void>;\n  /**  */\n  public preload: Promise<void>;\n  /** iframe */\n  public degradeAttrs: { [key: string]: any };\n  /** js */\n  public execQueue: Array<Function>;\n  /**  */\n  public execFlag: boolean;\n  /**  */\n  public activeFlag: boolean;\n  /** mount */\n  public mountFlag: boolean;\n  /**  */\n  public sync: boolean;\n  /**  */\n  public prefix: { [key: string]: string };\n  /**  */\n  public hrefFlag: boolean;\n  /** fiber */\n  public fiber: boolean;\n  /**  */\n  public degrade: boolean;\n  /** document */\n  public document: Document;\n  /** styleSheet */\n  public styleSheetElements: Array<HTMLLinkElement | HTMLStyleElement>;\n  /** head */\n  public head: HTMLHeadElement;\n  /** body */\n  public body: HTMLBodyElement;\n  /** dom */\n  public elementEventCacheMap: WeakMap<\n    Node,\n    Array<{ type: string; handler: EventListenerOrEventListenerObject; options: any }>\n  > = new WeakMap();\n\n  /** $wujie */\n  public provide: {\n    bus: EventBus;\n    shadowRoot?: ShadowRoot;\n    props?: { [key: string]: any };\n    location?: Object;\n  };\n\n  /**  */\n  public inject: {\n    idToSandboxMap: Map<String, SandboxCache>;\n    appEventObjMap: Map<String, EventObj>;\n    mainHostPath: string;\n  };\n\n  /** \n   * 1\n   * 2iframefetch\n   * 3shadow\n   * 4\n   */\n  public async active(options: {\n    url: string;\n    sync?: boolean;\n    prefix?: { [key: string]: string };\n    template?: string;\n    el?: string | HTMLElement;\n    props?: { [key: string]: any };\n    alive?: boolean;\n    fetch?: (input: RequestInfo, init?: RequestInit) => Promise<Response>;\n    replace?: (code: string) => string;\n  }): Promise<void> {\n    const { sync, url, el, template, props, alive, prefix, fetch, replace } = options;\n    this.url = url;\n    this.sync = sync;\n    this.alive = alive;\n    this.hrefFlag = false;\n    this.prefix = prefix ?? this.prefix;\n    this.replace = replace ?? this.replace;\n    this.provide.props = props ?? this.provide.props;\n    this.activeFlag = true;\n    // wait iframe init\n    await this.iframeReady;\n\n    // fetch\n    // TODO fetch\n    const iframeWindow = this.iframe.contentWindow;\n    const iframeFetch = fetch\n      ? (input: RequestInfo, init?: RequestInit) =>\n          fetch(typeof input === \"string\" ? getAbsolutePath(input, (this.proxyLocation as Location).href) : input, init)\n      : this.fetch;\n    if (iframeFetch) {\n      iframeWindow.fetch = iframeFetch;\n      this.fetch = iframeFetch;\n    }\n\n    // \n    if (this.execFlag && this.alive) {\n      // \n      syncUrlToWindow(iframeWindow);\n    } else {\n      // urliframeurl\n      syncUrlToIframe(iframeWindow);\n      syncUrlToWindow(iframeWindow);\n    }\n\n    // inject template\n    this.template = template ?? this.template;\n\n    /*  */\n    if (this.degrade) {\n      const iframeBody = rawDocumentQuerySelector.call(iframeWindow.document, \"body\") as HTMLElement;\n      const { iframe, container } = initRenderIframeAndContainer(this.id, el ?? iframeBody, this.degradeAttrs);\n      this.el = container;\n      // jsiframedom\n      if (el) clearChild(iframeBody);\n      // vueevent.timeStamp\n      patchEventTimeStamp(iframe.contentWindow, iframeWindow);\n      // iframeunmount\n      iframe.contentWindow.onunload = () => {\n        this.unmount();\n      };\n      if (this.document) {\n        if (this.alive) {\n          iframe.contentDocument.replaceChild(this.document.documentElement, iframe.contentDocument.documentElement);\n          // \n          recoverEventListeners(iframe.contentDocument.documentElement, iframeWindow);\n        } else {\n          await renderTemplateToIframe(iframe.contentDocument, this.iframe.contentWindow, this.template);\n          // react16\n          recoverDocumentListeners(this.document.documentElement, iframe.contentDocument.documentElement, iframeWindow);\n        }\n      } else {\n        await renderTemplateToIframe(iframe.contentDocument, this.iframe.contentWindow, this.template);\n      }\n      this.document = iframe.contentDocument;\n      return;\n    }\n\n    if (this.shadowRoot) {\n      /*\n       document.addEventListener was transfer to shadowRoot.addEventListener\n       react 16 SyntheticEvent will remember document event for avoid repeat listen\n       shadowRoot have to dispatchEvent for react 16 so can't be destroyed\n       this may lead memory leak risk\n       */\n      this.el = renderElementToContainer(this.shadowRoot.host, el);\n      if (this.alive) return;\n    } else {\n      // iframeWeb Componentconnect\n      const iframeBody = rawDocumentQuerySelector.call(iframeWindow.document, \"body\") as HTMLElement;\n      this.el = renderElementToContainer(createWujieWebComponent(this.id), el ?? iframeBody);\n    }\n\n    await renderTemplateToShadowRoot(this.shadowRoot, iframeWindow, this.template);\n    this.patchCssRules();\n\n    // inject shadowRoot to app\n    this.provide.shadowRoot = this.shadowRoot;\n  }\n\n  /** \n   * 1js\n   * 2\n   */\n  public async start(getExternalScripts: () => ScriptResultList): Promise<void> {\n    this.execFlag = true;\n    // \n    const scriptResultList = await getExternalScripts();\n    // \n    if (!this.iframe) return;\n    const iframeWindow = this.iframe.contentWindow;\n    // \n    iframeWindow.__POWERED_BY_WUJIE__ = true;\n    // \n    const beforeScriptResultList: ScriptObjectLoader[] = getPresetLoaders(\"jsBeforeLoaders\", this.plugins);\n    // \n    const afterScriptResultList: ScriptObjectLoader[] = getPresetLoaders(\"jsAfterLoaders\", this.plugins);\n    // \n    const syncScriptResultList: ScriptResultList = [];\n    // async\n    const asyncScriptResultList: ScriptResultList = [];\n    // deferDOMContentLoaded\n    const deferScriptResultList: ScriptResultList = [];\n    scriptResultList.forEach((scriptResult) => {\n      if (scriptResult.defer) deferScriptResultList.push(scriptResult);\n      else if (scriptResult.async) asyncScriptResultList.push(scriptResult);\n      else syncScriptResultList.push(scriptResult);\n    });\n\n    // \n    beforeScriptResultList.forEach((beforeScriptResult) => {\n      this.execQueue.push(() =>\n        this.fiber\n          ? requestIdleCallback(() => insertScriptToIframe(beforeScriptResult, iframeWindow))\n          : insertScriptToIframe(beforeScriptResult, iframeWindow)\n      );\n    });\n\n    // \n    syncScriptResultList.concat(deferScriptResultList).forEach((scriptResult) => {\n      this.execQueue.push(() =>\n        scriptResult.contentPromise.then((content) =>\n          this.fiber\n            ? requestIdleCallback(() => insertScriptToIframe({ ...scriptResult, content }, iframeWindow))\n            : insertScriptToIframe({ ...scriptResult, content }, iframeWindow)\n        )\n      );\n    });\n\n    // \n    asyncScriptResultList.forEach((scriptResult) => {\n      scriptResult.contentPromise.then((content) => {\n        this.fiber\n          ? requestIdleCallback(() => insertScriptToIframe({ ...scriptResult, content }, iframeWindow))\n          : insertScriptToIframe({ ...scriptResult, content }, iframeWindow);\n      });\n    });\n\n    //mount\n    this.execQueue.push(this.fiber ? () => requestIdleCallback(() => this.mount()) : () => this.mount());\n\n    // DOMContentLoaded \n    const domContentLoadedTrigger = () => {\n      eventTrigger(iframeWindow.document, \"DOMContentLoaded\");\n      eventTrigger(iframeWindow, \"DOMContentLoaded\");\n      this.execQueue.shift()?.();\n    };\n    this.execQueue.push(this.fiber ? () => requestIdleCallback(domContentLoadedTrigger) : domContentLoadedTrigger);\n\n    // \n    afterScriptResultList.forEach((afterScriptResult) => {\n      this.execQueue.push(() =>\n        this.fiber\n          ? requestIdleCallback(() => insertScriptToIframe(afterScriptResult, iframeWindow))\n          : insertScriptToIframe(afterScriptResult, iframeWindow)\n      );\n    });\n\n    // loaded \n    const domLoadedTrigger = () => {\n      eventTrigger(iframeWindow.document, \"readystatechange\");\n      eventTrigger(iframeWindow, \"load\");\n      this.execQueue.shift()?.();\n    };\n    this.execQueue.push(this.fiber ? () => requestIdleCallback(domLoadedTrigger) : domLoadedTrigger);\n    // mountloading\n    if (this.alive || !isFunction(this.iframe.contentWindow.__WUJIE_UNMOUNT)) removeLoading(this.el);\n    this.execQueue.shift()();\n\n    // execQueuestart\n    return new Promise((resolve) => {\n      this.execQueue.push(() => {\n        resolve();\n        this.execQueue.shift()?.();\n      });\n    });\n  }\n\n  /**\n   * mount__WUJIE_MOUNTasync\n   * fibermountmount\n   * __WUJIE_MOUNTwindowmount\n   * window.__WUJIE.mount()\n   */\n  public mount(): void {\n    if (this.mountFlag) return;\n    if (isFunction(this.iframe.contentWindow.__WUJIE_MOUNT)) {\n      removeLoading(this.el);\n      this.lifecycles?.beforeMount?.(this.iframe.contentWindow);\n      this.iframe.contentWindow.__WUJIE_MOUNT();\n      this.lifecycles?.afterMount?.(this.iframe.contentWindow);\n      this.mountFlag = true;\n    }\n    if (this.alive) {\n      this.lifecycles?.activated?.(this.iframe.contentWindow);\n    }\n    this.execQueue.shift()?.();\n  }\n\n  /** proxyLocation.hrefshadow */\n  public unmount(): void {\n    this.activeFlag = false;\n    // \n    clearInactiveAppUrl();\n    if (this.alive) {\n      this.lifecycles?.deactivated?.(this.iframe.contentWindow);\n    }\n    if (!this.mountFlag) return;\n    if (isFunction(this.iframe.contentWindow.__WUJIE_UNMOUNT) && !this.alive && !this.hrefFlag) {\n      this.lifecycles?.beforeUnmount?.(this.iframe.contentWindow);\n      this.iframe.contentWindow.__WUJIE_UNMOUNT();\n      this.lifecycles?.afterUnmount?.(this.iframe.contentWindow);\n      this.mountFlag = false;\n      this.bus.$clear();\n      if (!this.degrade) {\n        clearChild(this.shadowRoot);\n        // head body\n        removeEventListener(this.head);\n        removeEventListener(this.body);\n      }\n      clearChild(this.head);\n      clearChild(this.body);\n    }\n  }\n\n  /**  */\n  public destroy() {\n    this.bus.$clear();\n    this.shadowRoot = null;\n    this.proxy = null;\n    this.proxyDocument = null;\n    this.proxyLocation = null;\n    this.execQueue = null;\n    this.provide = null;\n    this.degradeAttrs = null;\n    this.styleSheetElements = null;\n    this.bus = null;\n    this.replace = null;\n    this.fetch = null;\n    this.execFlag = null;\n    this.mountFlag = null;\n    this.hrefFlag = null;\n    this.document = null;\n    this.head = null;\n    this.body = null;\n    this.elementEventCacheMap = null;\n    this.lifecycles = null;\n    this.plugins = null;\n    this.provide = null;\n    this.inject = null;\n    this.execQueue = null;\n    this.prefix = null;\n    //  dom\n    if (this.el) {\n      clearChild(this.el);\n      this.el = null;\n    }\n    //  iframe \n    if (this.iframe) {\n      this.iframe.parentNode?.removeChild(this.iframe);\n    }\n    deleteWujieById(this.id);\n  }\n\n  /** mount */\n  public rebuildStyleSheets(): void {\n    if (this.styleSheetElements && this.styleSheetElements.length) {\n      this.styleSheetElements.forEach((styleSheetElement) => {\n        rawElementAppendChild.call(this.degrade ? this.document.head : this.shadowRoot.head, styleSheetElement);\n      });\n    }\n    this.patchCssRules();\n  }\n\n  /**\n   * \n   * 1:root:host\n   * 2@font-faceshadowRoot\n   */\n  public patchCssRules(): void {\n    if (this.degrade) return;\n    if (this.shadowRoot.host.hasAttribute(WUJIE_DATA_ATTACH_CSS_FLAG)) return;\n    const [hostStyleSheetElement, fontStyleSheetElement] = getPatchStyleElements(\n      Array.from(this.iframe.contentDocument.querySelectorAll(\"style\")).map(\n        (styleSheetElement) => styleSheetElement.sheet\n      )\n    );\n    if (hostStyleSheetElement) {\n      this.shadowRoot.head.appendChild(hostStyleSheetElement);\n      this.styleSheetElements.push(hostStyleSheetElement);\n    }\n    if (fontStyleSheetElement) {\n      this.shadowRoot.host.appendChild(fontStyleSheetElement);\n    }\n    (hostStyleSheetElement || fontStyleSheetElement) &&\n      this.shadowRoot.host.setAttribute(WUJIE_DATA_ATTACH_CSS_FLAG, \"\");\n  }\n\n  /**\n   * @param id id\n   * @param url urlprotocolhostpathqueryhash\n   */\n  constructor(options: {\n    name: string;\n    url: string;\n    attrs: { [key: string]: any };\n    degradeAttrs: { [key: string]: any };\n    fiber: boolean;\n    degrade;\n    plugins: Array<plugin>;\n    lifecycles: lifecycles;\n  }) {\n    // inject\n    if (window.__POWERED_BY_WUJIE__) this.inject = window.__WUJIE.inject;\n    else {\n      this.inject = {\n        idToSandboxMap: idToSandboxCacheMap,\n        appEventObjMap,\n        mainHostPath: window.location.protocol + \"//\" + window.location.host,\n      };\n    }\n    const { name, url, attrs, fiber, degradeAttrs, degrade, lifecycles, plugins } = options;\n    this.id = name;\n    this.fiber = fiber;\n    this.degrade = degrade || !wujieSupport;\n    this.bus = new EventBus(this.id);\n    this.url = url;\n    this.degradeAttrs = degradeAttrs;\n    this.provide = { bus: this.bus };\n    this.styleSheetElements = [];\n    this.execQueue = [];\n    this.lifecycles = lifecycles;\n    this.plugins = getPlugins(plugins);\n\n    // \n    const { urlElement, appHostPath, appRoutePath } = appRouteParse(url);\n    const { mainHostPath } = this.inject;\n    // iframe\n    this.iframe = iframeGenerator(this, attrs, mainHostPath, appHostPath, appRoutePath);\n\n    if (this.degrade) {\n      const { proxyDocument, proxyLocation } = localGenerator(this.iframe, urlElement, mainHostPath, appHostPath);\n      this.proxyDocument = proxyDocument;\n      this.proxyLocation = proxyLocation;\n    } else {\n      const { proxyWindow, proxyDocument, proxyLocation } = proxyGenerator(\n        this.iframe,\n        urlElement,\n        mainHostPath,\n        appHostPath\n      );\n      this.proxy = proxyWindow;\n      this.proxyDocument = proxyDocument;\n      this.proxyLocation = proxyLocation;\n    }\n    this.provide.location = this.proxyLocation;\n\n    addSandboxCacheWithWujie(this.id, this);\n  }\n}\n","import importHTML, { processCssLoader } from \"./entry\";\nimport { StyleObject, ScriptAttributes } from \"./template\";\nimport WuJie, { lifecycle } from \"./sandbox\";\nimport { defineWujieWebComponent, addLoading } from \"./shadow\";\nimport { processAppForHrefJump } from \"./sync\";\nimport { getPlugins } from \"./plugin\";\nimport {\n  wujieSupport,\n  mergeOptions,\n  isFunction,\n  requestIdleCallback,\n  isMatchSyncQueryById,\n  warn,\n  stopMainAppRun,\n} from \"./utils\";\nimport { getWujieById, getOptionsById, addSandboxCacheWithOptions } from \"./common\";\nimport { EventBus } from \"./event\";\nimport { WUJIE_TIPS_NOT_SUPPORTED } from \"./constant\";\n\nexport const bus = new EventBus(Date.now().toString());\n\nexport interface ScriptObjectLoader {\n  /**  */\n  src?: string;\n  /** module */\n  module?: boolean;\n  /** async */\n  async?: boolean;\n  /** crossorigin */\n  crossorigin?: boolean;\n  /** crossorigin */\n  crossoriginType?: \"anonymous\" | \"use-credentials\" | \"\";\n  /**  */\n  attrs?: ScriptAttributes;\n  /** script */\n  content?: string;\n  /**  */\n  callback?: (appWindow: Window) => any;\n  /**  */\n  onload?: Function;\n}\nexport interface plugin {\n  /** htmlloader */\n  htmlLoader?: (code: string) => string;\n  /** js */\n  jsExcludes?: Array<string | RegExp>;\n  /** js */\n  jsIgnores?: Array<string | RegExp>;\n  /** jsloader */\n  jsBeforeLoaders?: Array<ScriptObjectLoader>;\n  /** jsloader */\n  jsLoader?: (code: string, url: string, base: string) => string;\n  /** jsloader */\n  jsAfterLoaders?: Array<ScriptObjectLoader>;\n  /** css */\n  cssExcludes?: Array<string | RegExp>;\n  /** css */\n  cssIgnores?: Array<string | RegExp>;\n  /** cssloader */\n  cssBeforeLoaders?: Array<StyleObject>;\n  /** cssloader */\n  cssLoader?: (code: string, url: string, base: string) => string;\n  /** cssloader */\n  cssAfterLoaders?: Array<StyleObject>;\n  /**  window addEventListener  */\n  windowAddEventListenerHook?: eventListenerHook;\n  /**  window removeEventListener  */\n  windowRemoveEventListenerHook?: eventListenerHook;\n  /**  document addEventListener  */\n  documentAddEventListenerHook?: eventListenerHook;\n  /**  document removeEventListener  */\n  documentRemoveEventListenerHook?: eventListenerHook;\n  /**  bodyhead */\n  appendOrInsertElementHook?: <T extends Node>(element: T, iframeWindow: Window) => void;\n  /**  */\n  patchElementHook?: <T extends Node>(element: T, iframeWindow: Window) => void;\n  /**  window  */\n  windowPropertyOverride?: (iframeWindow: Window) => void;\n  /**  document  */\n  documentPropertyOverride?: (iframeWindow: Window) => void;\n}\n\ntype eventListenerHook = (\n  iframeWindow: Window,\n  type: string,\n  handler: EventListenerOrEventListenerObject,\n  options?: boolean | AddEventListenerOptions\n) => void;\n\nexport type loadErrorHandler = (url: string, e: Error) => any;\n\ntype baseOptions = {\n  /**  */\n  name: string;\n  /** url */\n  url: string;\n  /** html, url */\n  html?: string;\n  /**  */\n  replace?: (code: string) => string;\n  /** fetch */\n  fetch?: (input: RequestInfo, init?: RequestInit) => Promise<Response>;\n  /**  */\n  props?: { [key: string]: any };\n  /** iframe */\n  attrs?: { [key: string]: any };\n  /** iframe */\n  degradeAttrs?: { [key: string]: any };\n  /** fiber */\n  fiber?: boolean;\n  /** state */\n  alive?: boolean;\n  /** iframe */\n  degrade?: boolean;\n  /**  */\n  plugins?: Array<plugin>;\n  /**  */\n  beforeLoad?: lifecycle;\n  beforeMount?: lifecycle;\n  afterMount?: lifecycle;\n  beforeUnmount?: lifecycle;\n  afterUnmount?: lifecycle;\n  activated?: lifecycle;\n  deactivated?: lifecycle;\n  loadError?: loadErrorHandler;\n};\n\nexport type preOptions = baseOptions & {\n  /**  */\n  exec?: boolean;\n};\n\nexport type startOptions = baseOptions & {\n  /**  */\n  el: HTMLElement | string;\n  /**\n   * \n   * falsehistory\n   * https://html.spec.whatwg.org/multipage/history.html#the-history-interface\n   */\n  sync?: boolean;\n  /**  */\n  prefix?: { [key: string]: string };\n  /** loading */\n  loading?: HTMLElement;\n};\n\ntype optionProperty = \"url\" | \"el\";\n\n/**\n *  preOptions  startOptions url  el \n */\nexport type cacheOptions = Omit<preOptions & startOptions, optionProperty> &\n  Partial<Pick<startOptions, optionProperty>>;\n\n/**\n * \n * wujie.__WUJIE true\n * window.__POWERED_BY_WUJIE__ false\n * iframeloading\n */\nif (window.__WUJIE && !window.__POWERED_BY_WUJIE__) {\n  stopMainAppRun();\n}\n\n// \nprocessAppForHrefJump();\n\n// webComponent\ndefineWujieWebComponent();\n\n// \nif (!wujieSupport) warn(WUJIE_TIPS_NOT_SUPPORTED);\n\n/**\n * \n */\nexport function setupApp(options: cacheOptions): void {\n  if (options.name) addSandboxCacheWithOptions(options.name, options);\n}\n\n/**\n * app\n */\nexport async function startApp(startOptions: startOptions): Promise<Function | void> {\n  const sandbox = getWujieById(startOptions.name);\n  const cacheOptions = getOptionsById(startOptions.name);\n  // \n  const options = mergeOptions(startOptions, cacheOptions);\n  const {\n    name,\n    url,\n    html,\n    replace,\n    fetch,\n    props,\n    attrs,\n    degradeAttrs,\n    fiber,\n    alive,\n    degrade,\n    sync,\n    prefix,\n    el,\n    loading,\n    plugins,\n    lifecycles,\n  } = options;\n  // \n  if (sandbox) {\n    sandbox.plugins = getPlugins(plugins);\n    sandbox.lifecycles = lifecycles;\n    const iframeWindow = sandbox.iframe.contentWindow;\n    if (sandbox.preload) {\n      await sandbox.preload;\n    }\n    if (alive) {\n      // \n      await sandbox.active({ url, sync, prefix, el, props, alive, fetch, replace });\n      // \n      if (!sandbox.execFlag) {\n        sandbox.lifecycles?.beforeLoad?.(sandbox.iframe.contentWindow);\n        const { getExternalScripts } = await importHTML({\n          url,\n          html,\n          opts: {\n            fetch: fetch || window.fetch,\n            plugins: sandbox.plugins,\n            loadError: sandbox.lifecycles.loadError,\n            fiber,\n          },\n        });\n        await sandbox.start(getExternalScripts);\n      }\n      sandbox.lifecycles?.activated?.(sandbox.iframe.contentWindow);\n      return sandbox.destroy;\n    } else if (isFunction(iframeWindow.__WUJIE_MOUNT)) {\n      /**\n       * webcomponentdisconnectedCallbacksandbox.unmount\n       * webcomponentstartAppunmount\n       */\n      sandbox.unmount();\n      await sandbox.active({ url, sync, prefix, el, props, alive, fetch, replace });\n      // \n      sandbox.lifecycles?.beforeMount?.(sandbox.iframe.contentWindow);\n      iframeWindow.__WUJIE_MOUNT();\n      sandbox.lifecycles?.afterMount?.(sandbox.iframe.contentWindow);\n      sandbox.mountFlag = true;\n      sandbox.rebuildStyleSheets();\n      return sandbox.destroy;\n    } else {\n      // \n      sandbox.destroy();\n    }\n  }\n\n  // loading\n  addLoading(el, loading);\n  const newSandbox = new WuJie({ name, url, attrs, degradeAttrs, fiber, degrade, plugins, lifecycles });\n  newSandbox.lifecycles?.beforeLoad?.(newSandbox.iframe.contentWindow);\n  const { template, getExternalScripts, getExternalStyleSheets } = await importHTML({\n    url,\n    html,\n    opts: {\n      fetch: fetch || window.fetch,\n      plugins: newSandbox.plugins,\n      loadError: newSandbox.lifecycles.loadError,\n      fiber,\n    },\n  });\n\n  const processedHtml = await processCssLoader(newSandbox, template, getExternalStyleSheets);\n  await newSandbox.active({ url, sync, prefix, template: processedHtml, el, props, alive, fetch, replace });\n  await newSandbox.start(getExternalScripts);\n  return newSandbox.destroy;\n}\n\n/**\n * APP\n */\nexport function preloadApp(preOptions: preOptions): void {\n  requestIdleCallback((): void | Promise<void> => {\n    /**\n     * \n     * urlidurl\n     */\n    if (getWujieById(preOptions.name) || isMatchSyncQueryById(preOptions.name)) return;\n    const cacheOptions = getOptionsById(preOptions.name);\n    // \n    const options = mergeOptions({ ...preOptions }, cacheOptions);\n    const {\n      name,\n      url,\n      html,\n      props,\n      alive,\n      replace,\n      fetch,\n      exec,\n      attrs,\n      degradeAttrs,\n      fiber,\n      degrade,\n      prefix,\n      plugins,\n      lifecycles,\n    } = options;\n\n    const sandbox = new WuJie({ name, url, attrs, degradeAttrs, fiber, degrade, plugins, lifecycles });\n    if (sandbox.preload) return sandbox.preload;\n    const runPreload = async () => {\n      sandbox.lifecycles?.beforeLoad?.(sandbox.iframe.contentWindow);\n      const { template, getExternalScripts, getExternalStyleSheets } = await importHTML({\n        url,\n        html,\n        opts: {\n          fetch: fetch || window.fetch,\n          plugins: sandbox.plugins,\n          loadError: sandbox.lifecycles.loadError,\n          fiber,\n        },\n      });\n      const processedHtml = await processCssLoader(sandbox, template, getExternalStyleSheets);\n      await sandbox.active({ url, props, prefix, alive, template: processedHtml, fetch, replace });\n      if (exec) {\n        await sandbox.start(getExternalScripts);\n      } else {\n        await getExternalScripts();\n      }\n    };\n    sandbox.preload = runPreload();\n  });\n}\n\n/**\n * APP\n */\nexport function destroyApp(id: string): void {\n  const sandbox = getWujieById(id);\n  if (sandbox) {\n    sandbox.destroy();\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}"],"names":["root","factory","exports","module","define","amd","self","_typeof","_regeneratorRuntime","__esModule","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","obj","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","state","method","arg","Error","undefined","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","resolve","reject","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","get","prop","r","_defineProperty","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","minLen","toString","from","test","_slicedToArray","isArray","_i","_s","_e","_arr","_n","_d","WUJIE_APP_ID","WUJIE_SCRIPT_ID","WUJIE_DATA_FLAG","CONTAINER_POSITION_DATA_FLAG","CONTAINER_OVERFLOW_DATA_FLAG","LOADING_DATA_FLAG","WUJIE_DATA_ATTACH_CSS_FLAG","WUJIE_ALL_EVENT","WUJIE_SHADE_STYLE","WUJIE_TIPS_RELOAD_DISABLED","WUJIE_TIPS_NO_SUBJECT","WUJIE_TIPS_SCRIPT_ERROR_REQUESTED","WUJIE_TIPS_CSS_ERROR_REQUESTED","WUJIE_TIPS_HTML_ERROR_REQUESTED","WUJIE_TIPS_REPEAT_RENDER","isFunction","wujieSupport","window","Proxy","CustomElementRegistry","naughtySafari","document","all","callableFnCacheMap","WeakMap","isCallable","has","callable","set","boundedMap","isBoundedFunction","bounded","indexOf","fnRegexCheckCacheMap","isConstructable","hasPrototypeMethods","getOwnPropertyNames","constructable","fnString","setFnCacheMap","getTargetValue","target","p","boundValue","bind","getDegradeIframe","id","querySelector","setAttrsToElement","element","attrs","setAttribute","appRouteParse","url","urlElement","anchorElementGenerator","appHostPath","protocol","host","appRoutePath","pathname","search","hash","startsWith","createElement","href","getAnchorElementQueryMap","anchorElement","queryList","replace","split","queryMap","query","isMatchSyncQueryById","location","includes","fixElementCtrSrcOrHref","iframeWindow","elementCtr","attr","rawElementSetAttribute","Element","targetValue","getAbsolutePath","baseURI","rawAnchorElementHrefDescriptor","getOwnPropertyDescriptor","getCurUrl","proxyLocation","base","URL","requestIdleCallback","cb","setTimeout","getContainer","container","warn","msg","data","console","getInlineCode","match","start","end","lastIndexOf","substring","defaultGetPublicPath","origin","paths","join","e","compose","fnList","code","reduce","newCode","nextTick","execHooks","plugins","hookName","map","plugin","filter","hook","isScriptElement","tagName","toUpperCase","count","setTagToScript","tag","scriptTag","String","getTagFromScript","getAttribute","mergeOptions","options","cacheOptions","el","html","exec","fetch","props","sync","prefix","loading","degradeAttrs","fiber","alive","degrade","lifecycles","beforeLoad","beforeMount","afterMount","beforeUnmount","afterUnmount","activated","deactivated","loadError","eventTrigger","eventName","detail","event","CustomEvent","createEvent","initCustomEvent","dispatchEvent","stopMainAppRun","WUJIE_TIPS_STOP_APP","ALL_SCRIPT_REGEX","SCRIPT_TAG_REGEX","SCRIPT_SRC_REGEX","SCRIPT_TYPE_REGEX","SCRIPT_ENTRY_REGEX","SCRIPT_ASYNC_REGEX","DEFER_ASYNC_REGEX","SCRIPT_NO_MODULE_REGEX","SCRIPT_MODULE_REGEX","LINK_TAG_REGEX","LINK_PRELOAD_OR_PREFETCH_REGEX","LINK_HREF_REGEX","LINK_AS_FONT","STYLE_TAG_REGEX","STYLE_TYPE_REGEX","STYLE_HREF_REGEX","HTML_COMMENT_REGEX","LINK_IGNORE_REGEX","STYLE_IGNORE_REGEX","SCRIPT_IGNORE_REGEX","CROSS_ORIGIN_REGEX","hasProtocol","getEntirePath","path","parseTagAttributes","TagOuterHTML","matches","attributeMatches","attributesString","attributesPattern","attributesObject","attributeName","attributeValue","genLinkReplaceSymbol","linkHref","preloadOrPrefetch","getInlineStyleReplaceSymbol","index","genIgnoreAssetReplaceSymbol","genModuleScriptReplaceSymbol","scriptSrc","moduleSupport","_toConsumableArray","getCssLoader","src","cssLoader","getPresetLoaders","loaderType","res","loaders","preLoaders","curLoaders","concat","getEffectLoaders","isMatchUrl","effectLoaders","some","loader","defaultPlugin","baseUrl","_m","pre","post","cssBeforeLoaders","content","getPlugins","styleCache","scriptCache","embedHTMLCache","defaultFetch","defaultGetTemplate","tpl","processCssLoader","sandbox","template","getExternalStyleSheets","curUrl","composeCssLoader","processedCssList","ignore","contentPromise","getEmbedHTML","embedHTML","styleResultList","styleResult","isInlineCode","fetchAssets","cache","cssFlag","response","status","text","styles","getExternalScripts","scripts","script","defer","importHTML","params","opts","htmlLoader","jsExcludes","cssExcludes","jsIgnores","cssIgnores","getPublicPath","getHtmlParseResult","assetPublicPath","postProcessTemplate","styleHref","styleIgnore","newHref","scriptIgnore","isModuleScript","isCrossOriginScript","crossOriginType","moduleScriptIgnore","matchedScriptTypeMatch","matchedScriptEntry","matchedScriptSrcMatch","matchedScriptSrc","SyntaxError","isAsyncScript","isDeferScript","crossorigin","crossoriginType","genScriptReplaceSymbol","every","line","trim","tplResult","processTpl","style","_classCallCheck","instance","Constructor","_defineProperties","descriptor","_createClass","protoProps","staticProps","_setPrototypeOf","_possibleConstructorReturn","ReferenceError","_getPrototypeOf","_isNativeReflectConstruct","Reflect","construct","sham","Boolean","valueOf","_construct","Parent","Class","_wrapNativeSuper","_cache","Map","Wrapper","idToSandboxCacheMap","__POWERED_BY_WUJIE__","__WUJIE","inject","idToSandboxMap","getWujieById","wujie","getOptionsById","documentProxyProperties","appDocumentAddEventListenerEvents","appDocumentOnEvents","mainDocumentAddEventListenerEvents","mainAndAppAddEventListenerEvents","appWindowAddEventListenerEvents","appWindowOnEvent","relativeElementTagAttrMap","IMG","A","SOURCE","windowProxyProperties","windowRegWhiteList","rawElementAppendChild","HTMLElement","appendChild","rawElementRemoveChild","removeChild","rawElementContains","contains","rawHeadInsertBefore","HTMLHeadElement","insertBefore","rawBodyInsertBefore","HTMLBodyElement","rawAddEventListener","Node","addEventListener","rawRemoveEventListener","removeEventListener","rawWindowAddEventListener","rawWindowRemoveEventListener","rawAppendChild","rawDocumentQuerySelector","__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR__","Document","manualInvokeElementEvent","elementGetter","patchedEvent","defineProperties","srcElement","handleStylesheetElementPatch","stylesheetElement","innerHTML","_patcher","clearTimeout","getPatchStyleElements","sheet","hostStyleSheetElement","fontStyleSheetElement","shadowRoot","head","dynamicScriptExecStack","rewriteAppendOrInsertChild","newChild","refChild","rawDOMAppendOrInsertBefore","wujieId","styleSheetElements","iframe","patchElementEffect","contentWindow","iframeDocument","contentDocument","rel","endsWith","rawAttrs","outerHTML","comment","createComment","_hasPatchStyle","innerHTMLDesc","innerTextDesc","textContentDesc","RawInsertRule","insertRule","patchSheetInsertRule","innerText","textContent","node","nodeType","TEXT_NODE","ownerDocument","createTextNode","rule","patchStylesheetElement","crossOrigin","execScript","scriptResult","insertScriptToIframe","onload","execQueue","execQueueLength","shift","findScriptElementFromIframe","rawElement","wujieTag","targetScript","__WUJIE_RAW_DOCUMENT_HEAD__","rewriteContains","other","patchEventListener","listenerMap","_cacheListeners","listener","listeners","typeListeners","splice","entries","patchRenderEffect","render","body","child","cssSelectorMap","renderElementToContainer","selectorOrElement","clearChild","initRenderIframeAndContainer","parent","createIframeContainer","open","write","close","processCssLoaderForTemplate","cssAfterLoaders","contentList","styleElement","firstChild","renderTemplateToHtml","execFlag","headElement","bodyElement","cloneNode","parentNode","replaceChild","replaceHeadAndBody","ElementIterator","createTreeWalker","NodeFilter","SHOW_ELEMENT","nextElement","currentNode","relativeAttr","nextNode","renderTemplateToShadowRoot","processedHtml","shade","defaultStyle","renderTemplateToIframe","renderDocument","documentElement","addLoading","containerStyles","getComputedStyle","position","overflow","setProperty","loadingContainer","removeLoading","positionFlag","overflowFlag","removeProperty","removeAttribute","rootStyleSheets","rootCssRules","fontCssRules","rootStyleReg","cssRules","j","cssRuleText","cssText","CSSRule","FONT_FACE_RULE","rootStyleSheetElement","syncUrlToWindow","winUrlElement","validShortPath","shortPath","longPath","encodeURIComponent","newQuery","history","replaceState","syncUrlToIframe","idUrl","syncUrl","decodeURIComponent","getSyncUrl","mainHostPath","patchIframeVariable","__WUJIE_PUBLIC_PATH__","$wujie","provide","__WUJIE_RAW_WINDOW__","updateBase","baseElement","recoverEventListeners","rootElement","elementEventCacheMap","elementListenerList","handler","recoverDocumentListeners","oldRootElement","newRootElement","patchEventTimeStamp","targetWindow","Event","timeStamp","_hasPatch","callback","scriptElement","nextScriptElement","jsLoader","getJsLoader","execNextScript","afterExecScript","isOutlineScript","onerror","renderIframeReplaceApp","iframeGenerator","iframeReady","oldDoc","loop","newDoc","execCommand","stopIframeLoading","implementation","createHTMLDocument","newDocumentElement","importNode","__WUJIE_RAW_DOCUMENT_QUERY_SELECTOR_ALL__","querySelectorAll","__WUJIE_RAW_DOCUMENT_CREATE_ELEMENT__","__WUJIE_RAW_DOCUMENT_CREATE_TEXT_NODE__","iframeUrlElement","appUrlElement","initBase","rawHistoryPushState","pushState","rawHistoryReplaceState","title","mainUrl","ignoreFlag","patchIframeHistory","patchIframeEvents","find","findIndex","ele","recordEventListeners","syncIframeUrlToWindow","processWindowProperty","message","reg","patchWindowEffect","handlerCallbackMap","handlerTypeMap","typeList","elementOnEvents","documentOnEvent","firstElementChild","val","ownerProperties","shadowProperties","shadowMethods","documentProperties","documentMethods","documentEvents","propKey","proxyDocument","patchDocumentEffect","rawGetRootNode","getRootNode","rawInsertRule","rootNode","patchNodeEffect","HTMLImageElement","HTMLAnchorElement","HTMLSourceElement","HTMLLinkElement","HTMLScriptElement","HTMLMediaElement","patchRelativeUrlEffect","initIframeDom","locationHrefSet","hrefElement","hrefFlag","iframeBody","parentElement","pushUrlToWindow","appEventObjMap","EventBus","$clear","eventObj","cbs","$on","on","$off","allCbs","l","Wujie","bus","wujieCache","documentURI","getElementsByTagName","modifyLocalProperties","locationKeys","constantKey","reload","localGenerator","proxyWindow","proxy","checkProxyFunction","_fakeDocument","rawCreateElement","rawCreateTextNode","_createElement","_ctx","ctx","rawPropMap","activeElement","_fakeLocation","ownKeys","_target","proxyGenerator","activeFlag","iframeFetch","input","init","onunload","unmount","contentElement","classList","add","patchCssRules","scriptResultList","beforeScriptResultList","afterScriptResultList","syncScriptResultList","asyncScriptResultList","deferScriptResultList","beforeScriptResult","mount","domContentLoadedTrigger","afterScriptResult","domLoadedTrigger","__WUJIE_UNMOUNT","mountFlag","__WUJIE_MOUNT","clearInactiveAppUrl","styleSheetElement","hasAttribute","Date","now","setupApp","addSandboxCacheWithOptions","startApp","startOptions","preload","active","destroy","rebuildStyleSheets","newSandbox","WuJie","preloadApp","preOptions","runPreload","destroyApp","customElements","WujieApp","subClass","superClass","attachShadow","mode","defineWujieWebComponent"],"sourceRoot":""}